pbjsChunk([101],{139:function(r,e,n){r.exports=n(140)},140:function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.currencyRates=e.currencySupportEnabled=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};e.setConfig=h,e.addBidResponseHook=m;var c=f(n(3)),i=n(4),t=n(7),u=(function(r){{if(r&&r.__esModule)return r;var e={};if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e.default=r,e}})(n(0)),s=f(n(2)),a=n(8);function f(r){return r&&r.__esModule?r:{default:r}}var d="http://currency.prebid.org/latest.json",l=4,y=[],p={},v=!1,g="USD",b=e.currencySupportEnabled=!1,C=e.currencyRates={},S={};function h(r){var n=d;"object"===o(r.rates)&&(C.conversions=r.rates,v=!0),"string"==typeof r.adServerCurrency?(u.logInfo("enabling currency support",arguments),g=r.adServerCurrency,r.conversionRateFile&&(u.logInfo("currency using override conversionRateFile:",r.conversionRateFile),n=r.conversionRateFile),(function(r){p={},e.currencySupportEnabled=b=!0,u.logInfo("Installing addBidResponse decorator for currency module",arguments),s.default.addBidResponse.addHook(m,100),C.conversions||(0,t.ajax)(r,(function(r){try{e.currencyRates=C=JSON.parse(r),u.logInfo("currencyRates set to "+JSON.stringify(C)),v=!0,R()}catch(e){u.logError("failed to parse currencyRates response: "+r)}}))})(n)):(u.logInfo("disabling currency support"),(function(){u.logInfo("Uninstalling addBidResponse decorator for currency module",arguments),s.default.addBidResponse.removeHook(m),g="USD",p={},e.currencySupportEnabled=b=!1,v=!1,e.currencyRates=C={},S={}})()),"object"===o(r.bidderCurrencyDefault)&&(S=r.bidderCurrencyDefault)}function m(r,e,n){if(!e)return n.apply(this,arguments);var o,t,s,a=e.bidderCode||e.bidder;if(S[a]){var f=S[a];e.currency&&f!==e.currency?u.logWarn("Currency default '"+a+": "+f+"' ignored. adapter specified '"+e.currency+"'"):e.currency=f}if(e.currency||(u.logWarn('Currency not specified on bid.  Defaulted to "USD"'),e.currency="USD"),e.currency===g)return n.apply(this,arguments);y.push((o=n,t=this,s=arguments,function(){var r=s[1];if(void 0!==r&&"currency"in r&&"cpm"in r){var e=r.currency;try{var n=(function(r){var e,n=null;if(r in p)n=p[r],u.logMessage("Using conversionCache value "+n+" for fromCurrency "+r);else if(!1===b){if("USD"!==r)throw new Error("Prebid currency support has not been enabled and fromCurrency is not USD");n=1}else if(r===g)n=1;else{var o=g;if(r in C.conversions){if(e=C.conversions[r],!(o in e))throw new Error("Specified adServerCurrency in config '"+o+"' not found in the currency rates file");n=e[o],u.logInfo("getCurrencyConversion using direct "+r+" to "+o+" conversionRate "+n)}else if(o in C.conversions){if(e=C.conversions[o],!(r in e))throw new Error("Specified fromCurrency '"+r+"' not found in the currency rates file");n=I(1/e[r],l),u.logInfo("getCurrencyConversion using reciprocal "+r+" to "+o+" conversionRate "+n)}else{var c=Object.keys(C.conversions)[0];if(!(r in C.conversions[c]))throw new Error("Specified fromCurrency '"+r+"' not found in the currency rates file");var i=1/C.conversions[c][r];if(!(o in C.conversions[c]))throw new Error("Specified adServerCurrency in config '"+o+"' not found in the currency rates file");var t=C.conversions[c][o];n=I(i*t,l),u.logInfo("getCurrencyConversion using intermediate "+r+" thru "+c+" to "+o+" conversionRate "+n)}}return r in p||(u.logMessage("Adding conversionCache value "+n+" for fromCurrency "+r),p[r]=n),n})(e);r.originalCpm=r.cpm,r.originalCurrency=r.currency,1!==n&&(r.cpm=(parseFloat(r.cpm)*n).toFixed(4),r.currency=g)}catch(e){u.logWarn("Returning NO_BID, getCurrencyConversion threw error: ",e),s[1]=c.default.createBid(i.STATUS.NO_BID,{bidder:r.bidderCode||r.bidder,bidId:r.adId})}}return o.apply(t,s)})),b&&!v||R()}function R(){for(;y.length>0;)y.shift()()}function I(r,e){for(var n=1,o=0;o<e;o++)n+="0";return Math.round(r*n)/n}a.config.getConfig("currency",(function(r){return h(r.currency)}))}},[139]);