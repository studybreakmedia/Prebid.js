{"version":3,"sources":["webpack:///./modules/sharethroughBidAdapter.js"],"names":["BIDDER_CODE","VERSION","STR_ENDPOINT","document","location","protocol","sharethroughAdapterSpec","code","isBidRequestValid","bid","params","pkey","bidder","buildRequests","bidRequests","map","method","url","data","bidId","placement_key","hbVersion","strVersion","hbSource","interpretResponse","req","body","Object","keys","length","creative","creatives","requestId","width","height","cpm","creativeId","creative_key","deal_id","currency","netRevenue","ttl","ad","generateAd","strRespId","btoa","JSON","stringify"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA,IAAMA,cAAc,cAApB;AACA,IAAMC,UAAU,OAAhB;AACA,IAAMC,eAAeC,SAASC,QAAT,CAAkBC,QAAlB,GAA6B,uCAAlD;;AAEO,IAAMC,4DAA0B;AACrCC,QAAMP,WAD+B;AAErCQ,qBAAmB;AAAA,WAAO,CAAC,CAACC,IAAIC,MAAJ,CAAWC,IAAb,IAAqBF,IAAIG,MAAJ,KAAeZ,WAA3C;AAAA,GAFkB;AAGrCa,iBAAe,uBAACC,WAAD,EAAiB;AAC9B,WAAOA,YAAYC,GAAZ,CAAgB,eAAO;AAC5B,aAAO;AACLC,gBAAQ,KADH;AAELC,aAAKf,YAFA;AAGLgB,cAAM;AACJC,iBAAOV,IAAIU,KADP;AAEJC,yBAAeX,IAAIC,MAAJ,CAAWC,IAFtB;AAGJU,qBAAW,kBAHP;AAIJC,sBAAYrB,OAJR;AAKJsB,oBAAU;AALN;AAHD,OAAP;AAWD,KAZM,CAAP;AAaD,GAjBoC;AAkBrCC,qBAAmB,iCAAWC,GAAX,EAAmB;AAAA,QAAhBC,IAAgB,QAAhBA,IAAgB;;AACpC,QAAI,CAACC,OAAOC,IAAP,CAAYF,IAAZ,EAAkBG,MAAvB,EAA+B,OAAO,EAAP;;AAE/B,QAAMC,WAAWJ,KAAKK,SAAL,CAAe,CAAf,CAAjB;;AAEA,WAAO,CAAC;AACNC,iBAAWP,IAAIP,IAAJ,CAASC,KADd;AAENc,aAAO,CAFD;AAGNC,cAAQ,CAHF;AAINC,WAAKL,SAASK,GAJR;AAKNC,kBAAYN,SAASA,QAAT,CAAkBO,YALxB;AAMNC,eAASR,SAASA,QAAT,CAAkBQ,OANrB;AAONC,gBAAU,KAPJ;AAQNC,kBAAY,IARN;AASNC,WAAK,GATC;AAUNC,UAAIC,WAAWjB,IAAX,EAAiBD,GAAjB;AAVE,KAAD,CAAP;AAYD;AAnCoC,CAAhC;;AAsCP,SAASkB,UAAT,CAAoBjB,IAApB,EAA0BD,GAA1B,EAA+B;AAC7B,MAAMmB,8BAA4BnB,IAAIP,IAAJ,CAASC,KAA3C;;AAEA,8CAC8BM,IAAIP,IAAJ,CAASE,aADvC,kCACiFwB,SADjF,wCAGgBA,SAHhB,YAGgCC,KAAKC,KAAKC,SAAL,CAAerB,IAAf,CAAL,CAHhC;AAoBD;;AAED,mCAAepB,uBAAf,E","file":"sharethroughBidAdapter.js","sourcesContent":["import { registerBidder } from 'src/adapters/bidderFactory';\n\nconst BIDDER_CODE = 'sharethrough';\nconst VERSION = '2.0.0';\nconst STR_ENDPOINT = document.location.protocol + '//btlr.sharethrough.com/header-bid/v1';\n\nexport const sharethroughAdapterSpec = {\n  code: BIDDER_CODE,\n  isBidRequestValid: bid => !!bid.params.pkey && bid.bidder === BIDDER_CODE,\n  buildRequests: (bidRequests) => {\n    return bidRequests.map(bid => {\n      return {\n        method: 'GET',\n        url: STR_ENDPOINT,\n        data: {\n          bidId: bid.bidId,\n          placement_key: bid.params.pkey,\n          hbVersion: '0.34.1',\n          strVersion: VERSION,\n          hbSource: 'prebid'\n        }\n      };\n    })\n  },\n  interpretResponse: ({ body }, req) => {\n    if (!Object.keys(body).length) return [];\n\n    const creative = body.creatives[0];\n\n    return [{\n      requestId: req.data.bidId,\n      width: 0,\n      height: 0,\n      cpm: creative.cpm,\n      creativeId: creative.creative.creative_key,\n      deal_id: creative.creative.deal_id,\n      currency: 'USD',\n      netRevenue: true,\n      ttl: 360,\n      ad: generateAd(body, req)\n    }];\n  }\n}\n\nfunction generateAd(body, req) {\n  const strRespId = `str_response_${req.data.bidId}`;\n\n  return `\n    <div data-str-native-key=\"${req.data.placement_key}\" data-stx-response-name=\"${strRespId}\">\n    </div>\n    <script>var ${strRespId} = \"${btoa(JSON.stringify(body))}\"</script>\n    <script src=\"//native.sharethrough.com/assets/sfp-set-targeting.js\"></script>\n    <script>\n    (function() {\n      if (!(window.STR && window.STR.Tag) && !(window.top.STR && window.top.STR.Tag)) {\n        const sfp_js = document.createElement('script');\n        sfp_js.src = \"//native.sharethrough.com/assets/sfp.js\";\n        sfp_js.type = 'text/javascript';\n        sfp_js.charset = 'utf-8';\n        try {\n            window.top.document.getElementsByTagName('body')[0].appendChild(sfp_js);\n        } catch (e) {\n          console.log(e);\n        }\n      }\n    })()\n    </script>`;\n}\n\nregisterBidder(sharethroughAdapterSpec);\n\n\n\n// WEBPACK FOOTER //\n// ./modules/sharethroughBidAdapter.js"],"sourceRoot":""}