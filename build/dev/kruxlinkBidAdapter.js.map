{"version":3,"sources":["webpack:///./modules/kruxlinkBidAdapter.js"],"names":["bidfactory","require","bidmanager","adloader","adaptermanager","_qs","key","value","encodeURIComponent","_makeBidResponse","placementCode","bid","bidResponse","createBid","undefined","bidderCode","cpm","price","ad","adm","width","w","height","h","addBidResponse","_makeCallback","id","placements","callback","pbjs","response","seatbid","i","length","j","impid","hasOwnProperty","_callBids","params","impids","bids","bidRequest","bidRequestParams","push","bidderRequestId","qs","window","location","href","join","url","loadScript","KruxAdapter","callBids","registerBidAdapter","module","exports"],"mappings":"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","file":"kruxlinkBidAdapter.js","sourcesContent":["var bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar adloader = require('src/adloader.js');\nvar adaptermanager = require('src/adaptermanager');\n\nfunction _qs(key, value) {\n  return encodeURIComponent(key) + '=' + encodeURIComponent(value);\n}\n\nfunction _makeBidResponse(placementCode, bid) {\n  var bidResponse = bidfactory.createBid(bid !== undefined ? 1 : 2);\n  bidResponse.bidderCode = 'kruxlink';\n  if (bid !== undefined) {\n    bidResponse.cpm = bid.price;\n    bidResponse.ad = bid.adm;\n    bidResponse.width = bid.w;\n    bidResponse.height = bid.h;\n  }\n  bidmanager.addBidResponse(placementCode, bidResponse);\n}\n\nfunction _makeCallback(id, placements) {\n  var callback = '_kruxlink_' + id;\n  pbjs[callback] = function(response) {\n    // Clean up our callback\n    delete pbjs[callback];\n\n    // Add in the bid respones\n    if (response.seatbid !== undefined) {\n      for (var i = 0; i < response.seatbid.length; i++) {\n        var seatbid = response.seatbid[i];\n        if (seatbid.bid !== undefined) {\n          for (var j = 0; j < seatbid.bid.length; j++) {\n            var bid = seatbid.bid[j];\n            if (bid.impid !== undefined) {\n              _makeBidResponse(placements[bid.impid], bid);\n              delete placements[bid.impid];\n            }\n          }\n        }\n      }\n    }\n\n    // Add any no-bids remaining\n    for (var impid in placements) {\n      if (placements.hasOwnProperty(impid)) {\n        _makeBidResponse(placements[impid]);\n      }\n    }\n  };\n\n  return 'pbjs.' + callback;\n}\n\nfunction _callBids(params) {\n  var impids = [];\n  var placements = {};\n\n  var bids = params.bids || [];\n  for (var i = 0; i < bids.length; i++) {\n    var bidRequest = bids[i];\n    var bidRequestParams = bidRequest.params || {};\n    var impid = bidRequestParams.impid;\n    placements[impid] = bidRequest.placementCode;\n\n    impids.push(impid);\n  }\n\n  var callback = _makeCallback(params.bidderRequestId, placements);\n  var qs = [\n    _qs('id', params.bidderRequestId),\n    _qs('u', window.location.href),\n    _qs('impid', impids.join(',')),\n    _qs('calltype', 'pbd'),\n    _qs('callback', callback)\n  ];\n  var url = 'https://link.krxd.net/hb?' + qs.join('&');\n\n  adloader.loadScript(url);\n}\n\nfunction KruxAdapter() {\n  return {\n    callBids: _callBids\n  };\n}\n\nadaptermanager.registerBidAdapter(new KruxAdapter(), 'kruxlink');\n\nmodule.exports = KruxAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/kruxlinkBidAdapter.js"],"sourceRoot":""}