{"version":3,"sources":["webpack:///./modules/pulsepointBidAdapter.js"],"names":["bidfactory","require","bidmanager","adloader","utils","adaptermanager","PulsePointAdapter","getJsStaticUrl","window","location","protocol","bidUrl","_callBids","params","pp","loadScript","bid","bids","i","length","bidRequest","requestBid","ppBidRequest","Ad","bidRequestOptions","display","e","logError","bidResponseAvailable","callback","bidResponseCallback","options","cn","ca","requestActions","BID","cu","adUnitId","placementCode","param","hasOwnProperty","bidResponse","adSize","cf","toUpperCase","split","createBid","bidderCode","bidder","cpm","bidCpm","ad","html","width","height","addBidResponse","passback","callBids","registerBidAdapter","module","exports"],"mappings":"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","file":"pulsepointBidAdapter.js","sourcesContent":["var bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar adloader = require('src/adloader.js');\nvar utils = require('src/utils.js');\nvar adaptermanager = require('src/adaptermanager');\n\nvar PulsePointAdapter = function PulsePointAdapter() {\n  var getJsStaticUrl = window.location.protocol + '//tag-st.contextweb.com/getjs.static.js';\n  var bidUrl = window.location.protocol + '//bid.contextweb.com/header/tag';\n\n  function _callBids(params) {\n    if (typeof window.pp === 'undefined') {\n      adloader.loadScript(getJsStaticUrl, function () { bid(params); }, true);\n    } else {\n      bid(params);\n    }\n  }\n\n  function bid(params) {\n    var bids = params.bids;\n    for (var i = 0; i < bids.length; i++) {\n      var bidRequest = bids[i];\n      requestBid(bidRequest);\n    }\n  }\n\n  function requestBid(bidRequest) {\n    try {\n      var ppBidRequest = new window.pp.Ad(bidRequestOptions(bidRequest));\n      ppBidRequest.display();\n    } catch (e) {\n      // register passback on any exceptions while attempting to fetch response.\n      utils.logError('pulsepoint.requestBid', 'ERROR', e);\n      bidResponseAvailable(bidRequest);\n    }\n  }\n\n  function bidRequestOptions(bidRequest) {\n    var callback = bidResponseCallback(bidRequest);\n    var options = {\n      cn: 1,\n      ca: window.pp.requestActions.BID,\n      cu: bidUrl,\n      adUnitId: bidRequest.placementCode,\n      callback: callback\n    };\n    for (var param in bidRequest.params) {\n      if (bidRequest.params.hasOwnProperty(param)) {\n        options[param] = bidRequest.params[param];\n      }\n    }\n    return options;\n  }\n\n  function bidResponseCallback(bid) {\n    return function (bidResponse) {\n      bidResponseAvailable(bid, bidResponse);\n    };\n  }\n\n  function bidResponseAvailable(bidRequest, bidResponse) {\n    if (bidResponse) {\n      var adSize = bidRequest.params.cf.toUpperCase().split('X');\n      var bid = bidfactory.createBid(1, bidRequest);\n      bid.bidderCode = bidRequest.bidder;\n      bid.cpm = bidResponse.bidCpm;\n      bid.ad = bidResponse.html;\n      bid.width = adSize[0];\n      bid.height = adSize[1];\n      bidmanager.addBidResponse(bidRequest.placementCode, bid);\n    } else {\n      var passback = bidfactory.createBid(2, bidRequest);\n      passback.bidderCode = bidRequest.bidder;\n      bidmanager.addBidResponse(bidRequest.placementCode, passback);\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n};\n\nadaptermanager.registerBidAdapter(new PulsePointAdapter(), 'pulsepoint');\n\nmodule.exports = PulsePointAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/pulsepointBidAdapter.js"],"sourceRoot":""}