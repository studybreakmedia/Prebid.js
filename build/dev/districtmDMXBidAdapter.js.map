{"version":3,"sources":["webpack:///./modules/districtmDMXBidAdapter.js"],"names":["bidfactory","require","bidmanager","adLoader","adaptermanager","DistrictmAdaptor","districtmAdaptor","districtmUrl","window","location","protocol","callBids","hb_dmx_res","loadScript","sendBids","params","handlerRes","response","bidObject","bid","parseFloat","result","cpm","createBid","bidderCode","bidder","width","height","ad","banner","addBidResponse","placementCode","bids","i","length","sizes","auction","fixSize","run","ssp","registerBidAdapter","module","exports"],"mappings":";;;;;;;;;;;;;;;;AAAA,IAAIA,aAAa,mBAAAC,CAAQ,CAAR,CAAjB;AACA,IAAIC,aAAa,mBAAAD,CAAQ,CAAR,CAAjB;AACA,IAAIE,WAAW,mBAAAF,CAAQ,CAAR,CAAf;AACA,IAAIG,iBAAiB,mBAAAH,CAAQ,CAAR,CAArB;;AAEA,IAAII,mBAAmB,SAASC,gBAAT,GAA4B;AAAA;;AACjD,MAAIC,eAAeC,OAAOC,QAAP,CAAgBC,QAAhB,GAA2B,8BAA9C;AACA,OAAKC,QAAL,GAAgB,kBAAU;AACxB,QAAI,CAACH,OAAOI,UAAZ,EAAwB;AACtBT,eAASU,UAAT,CAAoBN,YAApB,EAAkC,YAAM;AACtC,cAAKO,QAAL,CAAcC,MAAd;AACD,OAFD;AAGD,KAJD,MAIO;AACL,YAAKD,QAAL,CAAcC,MAAd;AACD;AACD,WAAOA,MAAP;AACD,GATD;;AAWA,OAAKC,UAAL,GAAkB,UAASC,QAAT,EAAmBC,SAAnB,EAA8B;AAC9C,QAAIC,YAAJ;AACA,QAAIC,WAAWH,SAASI,MAAT,CAAgBC,GAA3B,IAAkC,CAAtC,EAAyC;AACvCH,YAAMnB,WAAWuB,SAAX,CAAqB,CAArB,EAAwBL,SAAxB,CAAN;AACAC,UAAIK,UAAJ,GAAiBN,UAAUO,MAA3B;AACAN,UAAIG,GAAJ,GAAUL,SAASI,MAAT,CAAgBC,GAA1B;AACAH,UAAIO,KAAJ,GAAYT,SAASI,MAAT,CAAgBK,KAA5B;AACAP,UAAIQ,MAAJ,GAAaV,SAASI,MAAT,CAAgBM,MAA7B;AACAR,UAAIS,EAAJ,GAASX,SAASI,MAAT,CAAgBQ,MAAzB;AACA3B,iBAAW4B,cAAX,CAA0BZ,UAAUa,aAApC,EAAmDZ,GAAnD;AACD,KARD,MAQO;AACLA,YAAMnB,WAAWuB,SAAX,CAAqB,CAArB,EAAwBL,SAAxB,CAAN;AACAC,UAAIK,UAAJ,GAAiBN,UAAUO,MAA3B;AACAvB,iBAAW4B,cAAX,CAA0BZ,UAAUa,aAApC,EAAmDZ,GAAnD;AACD;;AAED,WAAOA,GAAP;AACD,GAjBD;;AAmBA,OAAKL,QAAL,GAAgB,UAASC,MAAT,EAAiB;AAC/B,QAAIiB,OAAOjB,OAAOiB,IAAlB;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAID,KAAKE,MAAzB,EAAiCD,GAAjC,EAAsC;AACpCD,WAAKC,CAAL,EAAQlB,MAAR,CAAeoB,KAAf,GAAuB3B,OAAOI,UAAP,CAAkBwB,OAAlB,CAA0BC,OAA1B,CAAkCL,KAAKC,CAAL,EAAQE,KAA1C,CAAvB;AACD;AACD3B,WAAOI,UAAP,CAAkBwB,OAAlB,CAA0BE,GAA1B,CAA8B9B,OAAOI,UAAP,CAAkB2B,GAAhD,EAAqDP,IAArD,EAA2D,KAAKhB,UAAhE;AACA,WAAOgB,IAAP;AACD,GAPD;;AASA,SAAO;AACLrB,cAAU,KAAKA,QADV;AAELG,cAAU,KAAKA,QAFV;AAGLE,gBAAY,KAAKA;AAHZ,GAAP;AAKD,CA9CD;;AAgDAZ,eAAeoC,kBAAf,CAAkC,IAAInC,gBAAJ,EAAlC,EAA0D,cAA1D;;AAEAoC,OAAOC,OAAP,GAAiBrC,gBAAjB,C","file":"districtmDMXBidAdapter.js","sourcesContent":["var bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar adLoader = require('src/adloader');\nvar adaptermanager = require('src/adaptermanager');\n\nvar DistrictmAdaptor = function districtmAdaptor() {\n  let districtmUrl = window.location.protocol + '//prebid.districtm.ca/lib.js';\n  this.callBids = params => {\n    if (!window.hb_dmx_res) {\n      adLoader.loadScript(districtmUrl, () => {\n        this.sendBids(params);\n      });\n    } else {\n      this.sendBids(params);\n    }\n    return params;\n  };\n\n  this.handlerRes = function(response, bidObject) {\n    let bid;\n    if (parseFloat(response.result.cpm) > 0) {\n      bid = bidfactory.createBid(1, bidObject);\n      bid.bidderCode = bidObject.bidder;\n      bid.cpm = response.result.cpm;\n      bid.width = response.result.width;\n      bid.height = response.result.height;\n      bid.ad = response.result.banner;\n      bidmanager.addBidResponse(bidObject.placementCode, bid);\n    } else {\n      bid = bidfactory.createBid(2, bidObject);\n      bid.bidderCode = bidObject.bidder;\n      bidmanager.addBidResponse(bidObject.placementCode, bid);\n    }\n\n    return bid;\n  };\n\n  this.sendBids = function(params) {\n    var bids = params.bids;\n    for (var i = 0; i < bids.length; i++) {\n      bids[i].params.sizes = window.hb_dmx_res.auction.fixSize(bids[i].sizes);\n    }\n    window.hb_dmx_res.auction.run(window.hb_dmx_res.ssp, bids, this.handlerRes);\n    return bids;\n  };\n\n  return {\n    callBids: this.callBids,\n    sendBids: this.sendBids,\n    handlerRes: this.handlerRes\n  };\n};\n\nadaptermanager.registerBidAdapter(new DistrictmAdaptor(), 'districtmDMX');\n\nmodule.exports = DistrictmAdaptor;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/districtmDMXBidAdapter.js"],"sourceRoot":""}