{"version":3,"sources":["webpack:///./src/AnalyticsAdapter.js","webpack:///./modules/adomikAnalyticsAdapter.js"],"names":["AnalyticsAdapter","events","require","utils","AUCTION_INIT","EVENTS","AUCTION_END","BID_REQUESTED","BID_TIMEOUT","BID_RESPONSE","BID_WON","BID_ADJUSTMENT","SET_TARGETING","LIBRARY","ENDPOINT","BUNDLE","_sampled","url","analyticsType","global","handler","_queue","_eventCount","_enableCheck","_handlers","_emptyQueue","track","_track","enqueue","_enqueue","enableAnalytics","_enable","disableAnalytics","_disable","getAdapterType","getGlobal","getHandler","getUrl","eventType","args","window","_callEndpoint","arguments","callback","JSON","stringify","_this","push","config","options","sampling","Math","random","parseFloat","getEvents","forEach","event","call","_each","on","logMessage","off","i","length","fn","auctionInit","auctionEnd","bidRequested","bidResponse","bidWon","bidTimeout","bidwonTimeout","adomikAdapter","currentContext","id","requestId","timeout","undefined","timeouted","bucketEvents","type","buildBidResponse","adId","placementCode","adUnitCode","bids","bid","bidder","toUpperCase","setTimeout","sendTypedEvent","groupedTypedEvents","buildTypedEvents","bulkEvents","uid","ahbaid","hostname","location","eventsByPlacementCode","map","typedEventsByType","sizes","eventKeys","eventKey","typedEvent","size","sizeUtils","handleSize","encodedBuf","btoa","encodedUri","encodeURIComponent","splittedUrl","match","split","partUrl","img","Image","src","bidderCode","status","statusMessage","cpm","width","Number","height","timeToRespond","afterTimeout","sizeAlreadyExists","typedEventSize","find","formatSize","formattedSize","existTypedEvent","findIndex","groupedTypedEvent","adapterEnableAnalytics","initOptions","debug","registerAnalyticsAdapter","adapter","code"],"mappings":"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","file":"adomikAnalyticsAdapter.js","sourcesContent":["import CONSTANTS from './constants';\nimport { loadScript } from './adloader';\nimport { ajax } from './ajax';\n\nconst events = require('./events');\nconst utils = require('./utils');\n\nconst AUCTION_INIT = CONSTANTS.EVENTS.AUCTION_INIT;\nconst AUCTION_END = CONSTANTS.EVENTS.AUCTION_END;\nconst BID_REQUESTED = CONSTANTS.EVENTS.BID_REQUESTED;\nconst BID_TIMEOUT = CONSTANTS.EVENTS.BID_TIMEOUT;\nconst BID_RESPONSE = CONSTANTS.EVENTS.BID_RESPONSE;\nconst BID_WON = CONSTANTS.EVENTS.BID_WON;\nconst BID_ADJUSTMENT = CONSTANTS.EVENTS.BID_ADJUSTMENT;\nconst SET_TARGETING = CONSTANTS.EVENTS.SET_TARGETING;\n\nconst LIBRARY = 'library';\nconst ENDPOINT = 'endpoint';\nconst BUNDLE = 'bundle';\n\nvar _sampled = true;\n\nexport default function AnalyticsAdapter({ url, analyticsType, global, handler }) {\n  var _queue = [];\n  var _eventCount = 0;\n  var _enableCheck = true;\n  var _handlers;\n\n  if (analyticsType === LIBRARY) {\n    loadScript(url, _emptyQueue);\n  }\n\n  if (analyticsType === ENDPOINT || BUNDLE) {\n    _emptyQueue();\n  }\n\n  return {\n    track: _track,\n    enqueue: _enqueue,\n    enableAnalytics: _enable,\n    disableAnalytics: _disable,\n    getAdapterType: () => analyticsType,\n    getGlobal: () => global,\n    getHandler: () => handler,\n    getUrl: () => url\n  };\n\n  function _track({ eventType, args }) {\n    if (this.getAdapterType() === LIBRARY || BUNDLE) {\n      window[global](handler, eventType, args);\n    }\n\n    if (this.getAdapterType() === ENDPOINT) {\n      _callEndpoint(...arguments);\n    }\n  }\n\n  function _callEndpoint({ eventType, args, callback }) {\n    ajax(url, callback, JSON.stringify({ eventType, args }));\n  }\n\n  function _enqueue({ eventType, args }) {\n    const _this = this;\n\n    if (global && window[global] && eventType && args) {\n      this.track({ eventType, args });\n    } else {\n      _queue.push(function () {\n        _eventCount++;\n        _this.track({ eventType, args });\n      });\n    }\n  }\n\n  function _enable(config) {\n    var _this = this;\n\n    if (typeof config === 'object' && typeof config.options === 'object') {\n      _sampled = typeof config.options.sampling === 'undefined' || Math.random() < parseFloat(config.options.sampling);\n    } else {\n      _sampled = true;\n    }\n\n    if (_sampled) {\n      // first send all events fired before enableAnalytics called\n      events.getEvents().forEach(event => {\n        if (!event) {\n          return;\n        }\n\n        const { eventType, args } = event;\n\n        if (eventType !== BID_TIMEOUT) {\n          _enqueue.call(_this, { eventType, args });\n        }\n      });\n\n      // Next register event listeners to send data immediately\n\n      _handlers = {\n        [BID_REQUESTED]: args => this.enqueue({ eventType: BID_REQUESTED, args }),\n        [BID_RESPONSE]: args => this.enqueue({ eventType: BID_RESPONSE, args }),\n        [BID_TIMEOUT]: args => this.enqueue({ eventType: BID_TIMEOUT, args }),\n        [BID_WON]: args => this.enqueue({ eventType: BID_WON, args }),\n        [BID_ADJUSTMENT]: args => this.enqueue({ eventType: BID_ADJUSTMENT, args }),\n        [SET_TARGETING]: args => this.enqueue({ eventType: SET_TARGETING, args }),\n        [AUCTION_END]: args => this.enqueue({ eventType: AUCTION_END, args }),\n        [AUCTION_INIT]: args => {\n          args.config = config.options; // enableAnaltyics configuration object\n          this.enqueue({ eventType: AUCTION_INIT, args });\n        }\n      };\n\n      utils._each(_handlers, (handler, event) => {\n        events.on(event, handler);\n      });\n    } else {\n      utils.logMessage(`Analytics adapter for \"${global}\" disabled by sampling`);\n    }\n\n    // finally set this function to return log message, prevents multiple adapter listeners\n    this.enableAnalytics = function _enable() {\n      return utils.logMessage(`Analytics adapter for \"${global}\" already enabled, unnecessary call to \\`enableAnalytics\\`.`);\n    };\n  }\n\n  function _disable() {\n    utils._each(_handlers, (handler, event) => {\n      events.off(event, handler);\n    });\n  }\n\n  function _emptyQueue() {\n    if (_enableCheck) {\n      for (var i = 0; i < _queue.length; i++) {\n        _queue[i]();\n      }\n\n      // override push to execute the command immediately from now on\n      _queue.push = function (fn) {\n        fn();\n      };\n\n      _enableCheck = false;\n    }\n\n    utils.logMessage(`event count sent to ${global}: ${_eventCount}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/AnalyticsAdapter.js","import adapter from 'src/AnalyticsAdapter';\nimport CONSTANTS from 'src/constants.json';\nimport adaptermanager from 'src/adaptermanager';\n// import utils from 'src/utils';\n\n// Events used in adomik analytics adapter\nconst auctionInit = CONSTANTS.EVENTS.AUCTION_INIT;\nconst auctionEnd = CONSTANTS.EVENTS.AUCTION_END;\nconst bidRequested = CONSTANTS.EVENTS.BID_REQUESTED;\nconst bidResponse = CONSTANTS.EVENTS.BID_RESPONSE;\nconst bidWon = CONSTANTS.EVENTS.BID_WON;\nconst bidTimeout = CONSTANTS.EVENTS.BID_TIMEOUT;\n\nlet bidwonTimeout = 1000;\n\nlet adomikAdapter = Object.assign(adapter({}),\n  {\n    // Track every event needed\n    track({ eventType, args }) {\n      switch (eventType) {\n        case auctionInit:\n          adomikAdapter.currentContext.id = args.requestId\n          adomikAdapter.currentContext.timeout = args.timeout\n          if (args.config.bidwonTimeout !== undefined && typeof args.config.bidwonTimeout === 'number') {\n            bidwonTimeout = args.config.bidwonTimeout;\n          }\n          break;\n\n        case bidTimeout:\n          adomikAdapter.currentContext.timeouted = true;\n          break;\n\n        case bidResponse:\n          adomikAdapter.bucketEvents.push({\n            type: 'response',\n            event: adomikAdapter.buildBidResponse(args)\n          });\n          break;\n\n        case bidWon:\n          adomikAdapter.bucketEvents.push({\n            type: 'winner',\n            event: {\n              id: args.adId,\n              placementCode: args.adUnitCode\n            }\n          });\n          break;\n\n        case bidRequested:\n          args.bids.forEach(function(bid) {\n            adomikAdapter.bucketEvents.push({\n              type: 'request',\n              event: {\n                bidder: bid.bidder.toUpperCase(),\n                placementCode: bid.placementCode\n              }\n            });\n          });\n          break;\n\n        case auctionEnd:\n          setTimeout(() => {\n            if (adomikAdapter.bucketEvents.length > 0) {\n              adomikAdapter.sendTypedEvent();\n            }\n          }, bidwonTimeout);\n          break;\n      }\n    }\n  }\n);\n\nadomikAdapter.sendTypedEvent = function() {\n  const groupedTypedEvents = adomikAdapter.buildTypedEvents();\n\n  const bulkEvents = {\n    uid: adomikAdapter.currentContext.uid,\n    ahbaid: adomikAdapter.currentContext.id,\n    timeout: adomikAdapter.currentContext.timeout,\n    hostname: window.location.hostname,\n    eventsByPlacementCode: groupedTypedEvents.map(function(typedEventsByType) {\n      let sizes = [];\n      const eventKeys = ['request', 'response', 'winner'];\n      let events = {};\n\n      eventKeys.forEach((eventKey) => {\n        events[`${eventKey}s`] = [];\n        if (typedEventsByType[eventKey] !== undefined) {\n          typedEventsByType[eventKey].forEach((typedEvent) => {\n            if (typedEvent.event.size !== undefined) {\n              const size = adomikAdapter.sizeUtils.handleSize(sizes, typedEvent.event.size);\n              if (size !== null) {\n                sizes = [...sizes, size];\n              }\n            }\n            events[`${eventKey}s`] = [...events[`${eventKey}s`], typedEvent.event];\n          });\n        }\n      });\n\n      return {\n        placementCode: typedEventsByType.placementCode,\n        sizes,\n        events\n      };\n    })\n  };\n\n  // Encode object in base64\n  const encodedBuf = window.btoa(JSON.stringify(bulkEvents));\n\n  // Create final url and split it in 1600 characters max (+endpoint length)\n  const encodedUri = encodeURIComponent(encodedBuf);\n  const splittedUrl = encodedUri.match(/.{1,1600}/g);\n\n  splittedUrl.forEach((split, i) => {\n    const partUrl = `${split}&id=${adomikAdapter.currentContext.id}&part=${i}&on=${splittedUrl.length - 1}`;\n    const img = new Image(1, 1);\n    img.src = 'https://' + adomikAdapter.currentContext.url + '/?q=' + partUrl;\n  })\n};\n\nadomikAdapter.buildBidResponse = function (bid) {\n  return {\n    bidder: bid.bidderCode.toUpperCase(),\n    placementCode: bid.adUnitCode,\n    id: bid.adId,\n    status: (bid.statusMessage === 'Bid available') ? 'VALID' : 'EMPTY_OR_ERROR',\n    cpm: parseFloat(bid.cpm),\n    size: {\n      width: Number(bid.width),\n      height: Number(bid.height)\n    },\n    timeToRespond: bid.timeToRespond,\n    afterTimeout: adomikAdapter.currentContext.timeouted\n  };\n}\n\nadomikAdapter.sizeUtils = {\n  sizeAlreadyExists: (sizes, typedEventSize) => {\n    return sizes.find((size) => size.height === typedEventSize.height && size.width === typedEventSize.width);\n  },\n  formatSize: (typedEventSize) => {\n    return {\n      width: Number(typedEventSize.width),\n      height: Number(typedEventSize.height)\n    };\n  },\n  handleSize: (sizes, typedEventSize) => {\n    let formattedSize = null;\n    if (adomikAdapter.sizeUtils.sizeAlreadyExists(sizes, typedEventSize) === undefined) {\n      formattedSize = adomikAdapter.sizeUtils.formatSize(typedEventSize);\n    }\n    return formattedSize;\n  }\n};\n\nadomikAdapter.buildTypedEvents = function () {\n  const groupedTypedEvents = [];\n  adomikAdapter.bucketEvents.forEach(function(typedEvent, i) {\n    const [placementCode, type] = [typedEvent.event.placementCode, typedEvent.type];\n    let existTypedEvent = groupedTypedEvents.findIndex((groupedTypedEvent) => groupedTypedEvent.placementCode === placementCode);\n\n    if (existTypedEvent === -1) {\n      groupedTypedEvents.push({\n        placementCode: placementCode,\n        [type]: [typedEvent]\n      });\n      existTypedEvent = groupedTypedEvents.length - 1;\n    }\n\n    if (groupedTypedEvents[existTypedEvent][type]) {\n      groupedTypedEvents[existTypedEvent][type] = [...groupedTypedEvents[existTypedEvent][type], typedEvent];\n    } else {\n      groupedTypedEvents[existTypedEvent][type] = [typedEvent];\n    }\n  });\n\n  return groupedTypedEvents;\n}\n\n// Initialize adomik object\nadomikAdapter.currentContext = {};\nadomikAdapter.bucketEvents = [];\n\nadomikAdapter.adapterEnableAnalytics = adomikAdapter.enableAnalytics;\n\nadomikAdapter.enableAnalytics = function (config) {\n  const initOptions = config.options;\n  if (initOptions) {\n    adomikAdapter.currentContext = {\n      uid: initOptions.id,\n      url: initOptions.url,\n      debug: initOptions.debug,\n      id: '',\n      timeouted: false,\n      timeout: 0,\n    }\n    adomikAdapter.adapterEnableAnalytics(config);\n  }\n};\n\nadaptermanager.registerAnalyticsAdapter({\n  adapter: adomikAdapter,\n  code: 'adomik'\n});\n\nexport default adomikAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/adomikAnalyticsAdapter.js"],"sourceRoot":""}