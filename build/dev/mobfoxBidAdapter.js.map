{"version":3,"sources":["webpack:///./modules/mobfoxBidAdapter.js"],"names":["utils","require","BIDDER_CODE","BID_REQUEST_BASE_URL","CPM_HEADER","spec","code","aliases","isBidRequestValid","bid","params","s","undefined","requestId","buildRequests","validBidRequests","length","bidParams","rt","r_type","r_resp","u","window","navigator","userAgent","adspace_width","sizes","adspace_height","r_floor","o_andadvid","longitude","latitude","demo_age","adspace_strict","imp_instl","c_mraid","v_dur_min","v_dur_max","v_autoplay","v_startmute","v_rewarded","v_api","n_ver","n_adunit","n_layout","n_context","n_plcmttype","n_img_icon_req","n_img_icon_size","n_img_large_req","n_img_large_w","n_img_large_h","n_title_req","n_title_len","n_desc_req","n_desc_len","n_rating_req","payloadString","buildPayloadString","method","url","data","bidId","interpretResponse","serverResponse","bidRequest","bidResponses","serverResponseBody","body","error","errorMessage","logError","serverResponseHeaders","headers","bidRequestData","split","bidResponse","cpm","get","width","height","creativeId","currency","netRevenue","ttl","referrer","request","clickurl","ad","htmlString","push","e","key","hasOwnProperty","encodeURIComponent","_map","Object","keys","join"],"mappings":"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","file":"mobfoxBidAdapter.js","sourcesContent":["import {registerBidder} from 'src/adapters/bidderFactory';\n\nconst utils = require('src/utils.js');\nconst BIDDER_CODE = 'mobfox';\nconst BID_REQUEST_BASE_URL = 'https://my.mobfox.com/request.php';\nconst CPM_HEADER = 'X-Pricing-CPM';\n\nexport const spec = {\n  code: BIDDER_CODE,\n  aliases: ['mf'], // short code\n  isBidRequestValid: function (bid) {\n    return bid.params.s !== null && bid.params.s !== undefined && bid.requestId !== null && bid.requestId !== undefined;\n  },\n  buildRequests: function (validBidRequests) {\n    if (validBidRequests.length > 1) {\n      throw ('invalid number of valid bid requests, expected 1 element')\n    }\n\n    let bidParams = validBidRequests[0].params;\n    let bid = validBidRequests[0];\n\n    let params = {\n      // -------------------- Mandatory Parameters ------------------\n      rt: bidParams.rt || 'api-fetchip',\n      r_type: bidParams.r_type || 'banner',\n      r_resp: bidParams.r_resp || 'json', // string | vast20\n      //  i: bidParams.i || undefined , // string | 69.197.148.18\n      s: bidParams.s, // string | 80187188f458cfde788d961b6882fd53\n      u: bidParams.u || window.navigator.userAgent, // string\n\n      // ------------------- Global Parameters ----------------------\n      adspace_width: bidParams.adspace_width || bid.sizes[0][0], // integer | 320\n      adspace_height: bidParams.adspace_height || bid.sizes[0][1], // integer | 48\n      r_floor: bidParams.r_floor || undefined, // 0.8\n\n      o_andadvid: bidParams.o_andadvid || undefined, // 'c6292267-56ad-4326-965d-deef6fcd5er9'\n      longitude: bidParams.longitude || undefined, // 12.12\n      latitude: bidParams.latitude || undefined, // 280.12\n      demo_age: bidParams.demo_age || undefined, // 1978\n\n      // ------------------- banner / interstitial ----------------------\n      adspace_strict: bidParams.adspace_strict || undefined,\n\n      // ------------------- interstitial / video ----------------------\n      imp_instl: bidParams.imp_instl || undefined, // integer | 1\n\n      // ------------------- mraid ----------------------\n      c_mraid: bidParams.c_mraid || undefined, // integer | 1\n\n      // ------------------- video ----------------------\n      v_dur_min: bidParams.v_dur_min || undefined, // integer | 0\n      v_dur_max: bidParams.v_dur_max || undefined, // integer | 999\n      v_autoplay: bidParams.v_autoplay || undefined, // integer | 1\n      v_startmute: bidParams.v_startmute || undefined, // integer | 0\n      v_rewarded: bidParams.v_rewarded || undefined, // integer | 0\n      v_api: bidParams.v_api || undefined, // string | vpaid20\n      n_ver: bidParams.n_ver || undefined, //\n      n_adunit: bidParams.n_adunit || undefined, //\n      n_layout: bidParams.n_layout || undefined, //\n      n_context: bidParams.n_context || undefined, //\n      n_plcmttype: bidParams.n_plcmttype || undefined, //\n      n_img_icon_req: bidParams.n_img_icon_req || undefined, // boolean0\n      n_img_icon_size: bidParams.n_img_icon_size || undefined, // string80\n      n_img_large_req: bidParams.n_img_large_req || undefined, // boolean0\n      n_img_large_w: bidParams.n_img_large_w || undefined, // integer1200\n      n_img_large_h: bidParams.n_img_large_h || undefined, // integer627\n      n_title_req: bidParams.n_title_req || undefined, // boolean0\n      n_title_len: bidParams.n_title_len || undefined, // string25\n      n_desc_req: bidParams.n_desc_req || undefined, // boolean0\n      n_desc_len: bidParams.n_desc_len || undefined, // string140\n      n_rating_req: bidParams.n_rating_req || undefined\n    };\n\n    let payloadString = buildPayloadString(params);\n\n    return {\n      method: 'GET',\n      url: BID_REQUEST_BASE_URL,\n      data: payloadString,\n      requestId: bid.bidId\n    };\n  },\n  interpretResponse: function (serverResponse, bidRequest) {\n    const bidResponses = [];\n    let serverResponseBody = serverResponse.body;\n\n    if (!serverResponseBody || serverResponseBody.error) {\n      let errorMessage = `in response for ${BIDDER_CODE} adapter`;\n      if (serverResponseBody && serverResponseBody.error) {\n        errorMessage += `: ${serverResponseBody.error}`;\n      }\n      utils.logError(errorMessage);\n      return bidResponses;\n    }\n    try {\n      let serverResponseHeaders = serverResponse.headers;\n      let bidRequestData = bidRequest.data.split('&');\n      const bidResponse = {\n        requestId: bidRequest.requestId,\n        cpm: serverResponseHeaders.get(CPM_HEADER),\n        width: bidRequestData[5].split('=')[1],\n        height: bidRequestData[6].split('=')[1],\n        creativeId: bidRequestData[3].split('=')[1],\n        currency: 'USD',\n        netRevenue: true,\n        ttl: 360,\n        referrer: serverResponseBody.request.clickurl,\n        ad: serverResponseBody.request.htmlString\n      };\n      bidResponses.push(bidResponse);\n    } catch (e) {\n      throw 'could not build bid response: ' + e;\n    }\n    return bidResponses;\n  }\n};\n\nfunction buildPayloadString(params) {\n  for (let key in params) {\n    if (params.hasOwnProperty(key)) {\n      if (params[key] === undefined) {\n        delete params[key];\n      } else {\n        params[key] = encodeURIComponent(params[key]);\n      }\n    }\n  }\n\n  return utils._map(Object.keys(params), key => `${key}=${params[key]}`)\n    .join('&')\n}\n\nregisterBidder(spec);\n\n\n\n// WEBPACK FOOTER //\n// ./modules/mobfoxBidAdapter.js"],"sourceRoot":""}