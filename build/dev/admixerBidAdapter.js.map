{"version":3,"sources":["webpack:///./modules/admixerBidAdapter.js"],"names":["bidfactory","require","bidmanager","Ajax","utils","adaptermanager","AdmixerAdapter","invUrl","invVastUrl","_callBids","data","bids","i","ln","length","bid","params","parseSizesInput","sizes","join","zone","placementCode","mediaType","videoParams","video","_requestBid","bidObject","createBid","bidderCode","addBidResponse","callback_uid","url","ajax","_responseCallback","method","withCredentials","adUnit","JSON","parse","_error","result","cpm","logError","adUnitCode","vastUrl","ad","width","height","callBids","responseCallback","registerBidAdapter","supportedMediaTypes","module","exports"],"mappings":"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","file":"admixerBidAdapter.js","sourcesContent":["var bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar Ajax = require('src/ajax');\nvar utils = require('src/utils.js');\nvar adaptermanager = require('src/adaptermanager');\n\n/**\n * Adapter for requesting bids from Admixer.\n *\n * @returns {{callBids: _callBids,responseCallback: _responseCallback}}\n */\nvar AdmixerAdapter = function AdmixerAdapter() {\n  var invUrl = '//inv-nets.admixer.net/prebid.aspx';\n  var invVastUrl = '//inv-nets.admixer.net/videoprebid.aspx';\n\n  function _callBids(data) {\n    var bids = data.bids || [];\n    for (var i = 0, ln = bids.length; i < ln; i++) {\n      var bid = bids[i];\n      var params = {\n        'sizes': utils.parseSizesInput(bid.sizes).join('-'),\n        'zone': bid.params && bid.params.zone,\n        'callback_uid': bid.placementCode\n      };\n      if (params.zone) {\n        if (bid.mediaType === 'video') {\n          var videoParams = {};\n          if (typeof bid.video === 'object') {\n            Object.assign(videoParams, bid.video);\n          }\n          Object.assign(videoParams, params);\n          _requestBid(invVastUrl, params);\n        } else {\n          _requestBid(invUrl, params);\n        }\n      } else {\n        var bidObject = bidfactory.createBid(2);\n        bidObject.bidderCode = 'admixer';\n        bidmanager.addBidResponse(params.callback_uid, bidObject);\n      }\n    }\n  }\n\n  function _requestBid(url, params) {\n    Ajax.ajax(url, _responseCallback, params, {method: 'GET', withCredentials: true});\n  }\n\n  function _responseCallback(adUnit) {\n    try {\n      adUnit = JSON.parse(adUnit);\n    } catch (_error) {\n      adUnit = {result: {cpm: 0}};\n      utils.logError(_error);\n    }\n    var adUnitCode = adUnit.callback_uid;\n    var bid = adUnit.result;\n    var bidObject;\n    if (bid.cpm > 0) {\n      bidObject = bidfactory.createBid(1);\n      bidObject.bidderCode = 'admixer';\n      bidObject.cpm = bid.cpm;\n      if (bid.vastUrl) {\n        bidObject.mediaType = 'video';\n        bidObject.vastUrl = bid.vastUrl;\n      } else {\n        bidObject.ad = bid.ad;\n      }\n      bidObject.width = bid.width;\n      bidObject.height = bid.height;\n    } else {\n      bidObject = bidfactory.createBid(2);\n      bidObject.bidderCode = 'admixer';\n    }\n    bidmanager.addBidResponse(adUnitCode, bidObject);\n  }\n\n  return {\n    callBids: _callBids,\n    responseCallback: _responseCallback\n  };\n};\n\nadaptermanager.registerBidAdapter(new AdmixerAdapter(), 'admixer', {\n  supportedMediaTypes: ['video']\n});\n\nmodule.exports = AdmixerAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/admixerBidAdapter.js"],"sourceRoot":""}