{"version":3,"sources":["webpack:///./src/AnalyticsAdapter.js","webpack:///./modules/adkernelAdnAnalyticsAdapter.js"],"names":["AnalyticsAdapter","events","require","utils","AUCTION_INIT","EVENTS","AUCTION_END","BID_REQUESTED","BID_TIMEOUT","BID_RESPONSE","BID_WON","BID_ADJUSTMENT","SET_TARGETING","LIBRARY","ENDPOINT","BUNDLE","_sampled","url","analyticsType","global","handler","_queue","_eventCount","_enableCheck","_handlers","_emptyQueue","track","_track","enqueue","_enqueue","enableAnalytics","_enable","disableAnalytics","_disable","getAdapterType","getGlobal","getHandler","getUrl","eventType","args","window","_callEndpoint","arguments","callback","JSON","stringify","_this","push","config","options","sampling","Math","random","parseFloat","getEvents","forEach","event","call","_each","on","logMessage","off","i","length","fn","getUmtSource","ExpiringQueue","ANALYTICS_VERSION","DEFAULT_QUEUE_TIMEOUT","DEFAULT_HOST","ADK_HB_EVENTS","BID_REQUEST","TIMEOUT","buildRequestTemplate","pubId","getTopWindowUrl","ref","getTopWindowReferrer","topLocation","getTopWindowLocation","ver","domain","hostname","path","pathname","accId","env","screen","w","width","h","height","lang","navigator","language","src","analyticsAdapter","context","queue","init","trackAuctionInit","trackBidRequest","trackBidResponse","trackBidWon","trackBidTimeout","trackAuctionEnd","sendAll","originEnableAnalytics","logError","host","requestTemplate","queueTimeout","registerAnalyticsAdapter","adapter","code","popAll","req","hb_ev","auctionTimeStart","Date","now","createHbEvent","undefined","bids","map","bidderCode","bid","placementCode","adUnitCode","cpm","timeToRespond","bidderName","tagid","value","time","ev","val","UTM_TAGS","ADKERNEL_PREBID_KEY","DIRECT","REFERRAL","ORGANIC","storage","getItem","name","localStorage","setItem","pageUrl","referrer","prevUtm","getPreviousTrafficSource","currUtm","getCurrentTrafficSource","chooseActualUtm","updated","actual","storeUtm","getDirect","parse","source","getUTM","se","getSearchEngine","asUtm","parsedUrl","getReferrer","refHost","refPath","engines","engine","hasOwnProperty","test","urlParameters","search","utmArgs","utmTagName","utmValue","apply","utm","medium","campaign","term","content","c1","c2","c3","c4","c5","result","prev","curr","ord","isCampaignTraffic","indexOf","ttl","timeoutId","Array","reset","peekAll","clearTimeout","setTimeout"],"mappings":"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","file":"adkernelAdnAnalyticsAdapter.js","sourcesContent":["import CONSTANTS from './constants';\nimport { loadScript } from './adloader';\nimport { ajax } from './ajax';\n\nconst events = require('./events');\nconst utils = require('./utils');\n\nconst AUCTION_INIT = CONSTANTS.EVENTS.AUCTION_INIT;\nconst AUCTION_END = CONSTANTS.EVENTS.AUCTION_END;\nconst BID_REQUESTED = CONSTANTS.EVENTS.BID_REQUESTED;\nconst BID_TIMEOUT = CONSTANTS.EVENTS.BID_TIMEOUT;\nconst BID_RESPONSE = CONSTANTS.EVENTS.BID_RESPONSE;\nconst BID_WON = CONSTANTS.EVENTS.BID_WON;\nconst BID_ADJUSTMENT = CONSTANTS.EVENTS.BID_ADJUSTMENT;\nconst SET_TARGETING = CONSTANTS.EVENTS.SET_TARGETING;\n\nconst LIBRARY = 'library';\nconst ENDPOINT = 'endpoint';\nconst BUNDLE = 'bundle';\n\nvar _sampled = true;\n\nexport default function AnalyticsAdapter({ url, analyticsType, global, handler }) {\n  var _queue = [];\n  var _eventCount = 0;\n  var _enableCheck = true;\n  var _handlers;\n\n  if (analyticsType === LIBRARY) {\n    loadScript(url, _emptyQueue);\n  }\n\n  if (analyticsType === ENDPOINT || BUNDLE) {\n    _emptyQueue();\n  }\n\n  return {\n    track: _track,\n    enqueue: _enqueue,\n    enableAnalytics: _enable,\n    disableAnalytics: _disable,\n    getAdapterType: () => analyticsType,\n    getGlobal: () => global,\n    getHandler: () => handler,\n    getUrl: () => url\n  };\n\n  function _track({ eventType, args }) {\n    if (this.getAdapterType() === LIBRARY || BUNDLE) {\n      window[global](handler, eventType, args);\n    }\n\n    if (this.getAdapterType() === ENDPOINT) {\n      _callEndpoint(...arguments);\n    }\n  }\n\n  function _callEndpoint({ eventType, args, callback }) {\n    ajax(url, callback, JSON.stringify({ eventType, args }));\n  }\n\n  function _enqueue({ eventType, args }) {\n    const _this = this;\n\n    if (global && window[global] && eventType && args) {\n      this.track({ eventType, args });\n    } else {\n      _queue.push(function () {\n        _eventCount++;\n        _this.track({ eventType, args });\n      });\n    }\n  }\n\n  function _enable(config) {\n    var _this = this;\n\n    if (typeof config === 'object' && typeof config.options === 'object') {\n      _sampled = typeof config.options.sampling === 'undefined' || Math.random() < parseFloat(config.options.sampling);\n    } else {\n      _sampled = true;\n    }\n\n    if (_sampled) {\n      // first send all events fired before enableAnalytics called\n      events.getEvents().forEach(event => {\n        if (!event) {\n          return;\n        }\n\n        const { eventType, args } = event;\n\n        if (eventType !== BID_TIMEOUT) {\n          _enqueue.call(_this, { eventType, args });\n        }\n      });\n\n      // Next register event listeners to send data immediately\n\n      _handlers = {\n        [BID_REQUESTED]: args => this.enqueue({ eventType: BID_REQUESTED, args }),\n        [BID_RESPONSE]: args => this.enqueue({ eventType: BID_RESPONSE, args }),\n        [BID_TIMEOUT]: args => this.enqueue({ eventType: BID_TIMEOUT, args }),\n        [BID_WON]: args => this.enqueue({ eventType: BID_WON, args }),\n        [BID_ADJUSTMENT]: args => this.enqueue({ eventType: BID_ADJUSTMENT, args }),\n        [SET_TARGETING]: args => this.enqueue({ eventType: SET_TARGETING, args }),\n        [AUCTION_END]: args => this.enqueue({ eventType: AUCTION_END, args }),\n        [AUCTION_INIT]: args => {\n          args.config = config.options; // enableAnaltyics configuration object\n          this.enqueue({ eventType: AUCTION_INIT, args });\n        }\n      };\n\n      utils._each(_handlers, (handler, event) => {\n        events.on(event, handler);\n      });\n    } else {\n      utils.logMessage(`Analytics adapter for \"${global}\" disabled by sampling`);\n    }\n\n    // finally set this function to return log message, prevents multiple adapter listeners\n    this.enableAnalytics = function _enable() {\n      return utils.logMessage(`Analytics adapter for \"${global}\" already enabled, unnecessary call to \\`enableAnalytics\\`.`);\n    };\n  }\n\n  function _disable() {\n    utils._each(_handlers, (handler, event) => {\n      events.off(event, handler);\n    });\n  }\n\n  function _emptyQueue() {\n    if (_enableCheck) {\n      for (var i = 0; i < _queue.length; i++) {\n        _queue[i]();\n      }\n\n      // override push to execute the command immediately from now on\n      _queue.push = function (fn) {\n        fn();\n      };\n\n      _enableCheck = false;\n    }\n\n    utils.logMessage(`event count sent to ${global}: ${_eventCount}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/AnalyticsAdapter.js","import adapter from 'src/AnalyticsAdapter';\nimport CONSTANTS from 'src/constants.json';\nimport adaptermanager from 'src/adaptermanager';\nimport {parse} from 'src/url';\nimport * as utils from 'src/utils';\nimport {ajax} from 'src/ajax';\n\nconst ANALYTICS_VERSION = '1.0.0';\nconst DEFAULT_QUEUE_TIMEOUT = 4000;\nconst DEFAULT_HOST = 'tag.adkernel.com';\n\nconst ADK_HB_EVENTS = {\n  AUCTION_INIT: 'auctionInit',\n  BID_REQUEST: 'bidRequested',\n  BID_RESPONSE: 'bidResponse',\n  BID_WON: 'bidWon',\n  AUCTION_END: 'auctionEnd',\n  TIMEOUT: 'adapterTimedOut'\n};\n\nfunction buildRequestTemplate(pubId) {\n  const url = utils.getTopWindowUrl();\n  const ref = utils.getTopWindowReferrer();\n  const topLocation = utils.getTopWindowLocation();\n\n  return {\n    ver: ANALYTICS_VERSION,\n    domain: topLocation.hostname,\n    path: topLocation.pathname,\n    accId: pubId,\n    env: {\n      screen: {\n        w: window.screen.width,\n        h: window.screen.height\n      },\n      lang: navigator.language\n    },\n    src: getUmtSource(url, ref)\n  }\n}\n\nlet analyticsAdapter = Object.assign(adapter({analyticsType: 'endpoint'}),\n  {\n    track({ eventType, args }) {\n      if (!analyticsAdapter.context) {\n        return;\n      }\n      let handler = null;\n      switch (eventType) {\n        case CONSTANTS.EVENTS.AUCTION_INIT:\n          if (analyticsAdapter.context.queue) {\n            analyticsAdapter.context.queue.init();\n          }\n          handler = trackAuctionInit;\n          break;\n        case CONSTANTS.EVENTS.BID_REQUESTED:\n          handler = trackBidRequest;\n          break;\n        case CONSTANTS.EVENTS.BID_RESPONSE:\n          handler = trackBidResponse;\n          break;\n        case CONSTANTS.EVENTS.BID_WON:\n          handler = trackBidWon;\n          break;\n        case CONSTANTS.EVENTS.BID_TIMEOUT:\n          handler = trackBidTimeout;\n          break;\n        case CONSTANTS.EVENTS.AUCTION_END:\n          handler = trackAuctionEnd;\n          break;\n      }\n      if (handler) {\n        let events = handler(args);\n        if (analyticsAdapter.context.queue) {\n          analyticsAdapter.context.queue.push(events);\n        }\n        if (eventType === CONSTANTS.EVENTS.AUCTION_END) {\n          sendAll();\n        }\n      }\n    }\n  });\n\nanalyticsAdapter.context = {};\n\nanalyticsAdapter.originEnableAnalytics = analyticsAdapter.enableAnalytics;\n\nanalyticsAdapter.enableAnalytics = (config) => {\n  if (!config.options.pubId) {\n    utils.logError('PubId is not defined. Analytics won\\'t work');\n    return;\n  }\n  analyticsAdapter.context = {\n    host: config.options.host || DEFAULT_HOST,\n    pubId: config.options.pubId,\n    requestTemplate: buildRequestTemplate(config.options.pubId),\n    queue: new ExpiringQueue(sendAll, config.options.queueTimeout || DEFAULT_QUEUE_TIMEOUT)\n  };\n  analyticsAdapter.originEnableAnalytics(config);\n};\n\nadaptermanager.registerAnalyticsAdapter({\n  adapter: analyticsAdapter,\n  code: 'adkernelAdn'\n});\n\nexport default analyticsAdapter;\n\nfunction sendAll() {\n  let events = analyticsAdapter.context.queue.popAll();\n  if (events.length !== 0) {\n    let req = Object.assign({}, analyticsAdapter.context.requestTemplate, {hb_ev: events});\n    ajax(`//${analyticsAdapter.context.host}/hb-analytics`, () => {\n    }, JSON.stringify(req));\n  }\n}\n\nfunction trackAuctionInit() {\n  analyticsAdapter.context.auctionTimeStart = Date.now();\n  const event = createHbEvent(undefined, ADK_HB_EVENTS.AUCTION_INIT);\n  return [event];\n}\n\nfunction trackBidRequest(args) {\n  return args.bids.map(bid =>\n    createHbEvent(args.bidderCode, ADK_HB_EVENTS.BID_REQUEST, bid.placementCode));\n}\n\nfunction trackBidResponse(args) {\n  const event = createHbEvent(args.bidderCode, ADK_HB_EVENTS.BID_RESPONSE,\n    args.adUnitCode, args.cpm, args.timeToRespond / 1000);\n  return [event];\n}\n\nfunction trackBidWon(args) {\n  const event = createHbEvent(args.bidderCode, ADK_HB_EVENTS.BID_WON, args.adUnitCode, args.cpm);\n  return [event];\n}\n\nfunction trackAuctionEnd(args) {\n  const event = createHbEvent(undefined, ADK_HB_EVENTS.AUCTION_END, undefined,\n    undefined, (Date.now() - analyticsAdapter.context.auctionTimeStart) / 1000);\n  return [event];\n}\n\nfunction trackBidTimeout(args) {\n  return args.map(bidderName => createHbEvent(bidderName, ADK_HB_EVENTS.TIMEOUT));\n}\n\nfunction createHbEvent(adapter, event, tagid = undefined, value = 0, time = 0) {\n  let ev = { event: event };\n  if (adapter) {\n    ev.adapter = adapter\n  }\n  if (tagid) {\n    ev.tagid = tagid;\n  }\n  if (value) {\n    ev.val = value;\n  }\n  if (time) {\n    ev.time = time;\n  }\n  return ev;\n}\n\nconst UTM_TAGS = ['utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content',\n  'utm_c1', 'utm_c2', 'utm_c3', 'utm_c4', 'utm_c5'];\nconst ADKERNEL_PREBID_KEY = 'adk_dpt_analytics';\nconst DIRECT = '(direct)';\nconst REFERRAL = '(referral)';\nconst ORGANIC = '(organic)';\n\nexport let storage = {\n  getItem: (name) => {\n    return localStorage.getItem(name);\n  },\n  setItem: (name, value) => {\n    localStorage.setItem(name, value);\n  }\n};\n\nexport function getUmtSource(pageUrl, referrer) {\n  let prevUtm = getPreviousTrafficSource();\n  let currUtm = getCurrentTrafficSource(pageUrl, referrer);\n  let [updated, actual] = chooseActualUtm(prevUtm, currUtm);\n  if (updated) {\n    storeUtm(actual);\n  }\n  return actual;\n\n  function getPreviousTrafficSource() {\n    let val = storage.getItem(ADKERNEL_PREBID_KEY);\n    if (!val) {\n      return getDirect();\n    }\n    return JSON.parse(val);\n  }\n\n  function getCurrentTrafficSource(pageUrl, referrer) {\n    var source = getUTM(pageUrl);\n    if (source) {\n      return source;\n    }\n    if (referrer) {\n      let se = getSearchEngine(referrer);\n      if (se) {\n        return asUtm(se, ORGANIC, ORGANIC);\n      }\n      let parsedUrl = parse(pageUrl);\n      let [refHost, refPath] = getReferrer(referrer);\n      if (refHost && refHost !== parsedUrl.hostname) {\n        return asUtm(refHost, REFERRAL, REFERRAL, '', refPath);\n      }\n    }\n    return getDirect();\n  }\n\n  function getSearchEngine(pageUrl) {\n    let engines = {\n      'google': /^https?\\:\\/\\/(?:www\\.)?(?:google\\.(?:com?\\.)?(?:com|cat|[a-z]{2})|g.cn)\\//i,\n      'yandex': /^https?\\:\\/\\/(?:www\\.)?ya(?:ndex\\.(?:com|net)?\\.?(?:asia|mobi|org|[a-z]{2})?|\\.ru)\\//i,\n      'bing': /^https?\\:\\/\\/(?:www\\.)?bing\\.com\\//i,\n      'duckduckgo': /^https?\\:\\/\\/(?:www\\.)?duckduckgo\\.com\\//i,\n      'ask': /^https?\\:\\/\\/(?:www\\.)?ask\\.com\\//i,\n      'yahoo': /^https?\\:\\/\\/(?:[-a-z]+\\.)?(?:search\\.)?yahoo\\.com\\//i\n    };\n\n    for (let engine in engines) {\n      if (engines.hasOwnProperty(engine) && engines[engine].test(pageUrl)) {\n        return engine;\n      }\n    }\n  }\n\n  function getReferrer(referrer) {\n    let ref = parse(referrer);\n    return [ref.hostname, ref.pathname];\n  }\n\n  function getUTM(pageUrl) {\n    let urlParameters = parse(pageUrl).search;\n    if (!urlParameters['utm_campaign'] || !urlParameters['utm_source']) {\n      return;\n    }\n    let utmArgs = [];\n    utils._each(UTM_TAGS, (utmTagName) => {\n      let utmValue = urlParameters[utmTagName] || '';\n      utmArgs.push(utmValue);\n    });\n    return asUtm.apply(this, utmArgs);\n  }\n\n  function getDirect() {\n    return asUtm(DIRECT, DIRECT, DIRECT);\n  }\n\n  function storeUtm(utm) {\n    let val = JSON.stringify(utm);\n    storage.setItem(ADKERNEL_PREBID_KEY, val);\n  }\n\n  function asUtm(source, medium, campaign, term = '', content = '', c1 = '', c2 = '', c3 = '', c4 = '', c5 = '') {\n    let result = {\n      source: source,\n      medium: medium,\n      campaign: campaign\n    };\n    if (term) {\n      result.term = term;\n    }\n    if (content) {\n      result.content = content;\n    }\n    if (c1) {\n      result.c1 = c1;\n    }\n    if (c2) {\n      result.c2 = c2;\n    }\n    if (c3) {\n      result.c3 = c3;\n    }\n    if (c4) {\n      result.c4 = c4;\n    }\n    if (c5) {\n      result.c5 = c5;\n    }\n    return result;\n  }\n\n  function chooseActualUtm(prev, curr) {\n    if (ord(prev) < ord(curr)) {\n      return [true, curr];\n    } if (ord(prev) > ord(curr)) {\n      return [false, prev];\n    } else {\n      if (prev.campaign === REFERRAL && prev.content !== curr.content) {\n        return [true, curr];\n      } else if (prev.campaign === ORGANIC && prev.source !== curr.source) {\n        return [true, curr];\n      } else if (isCampaignTraffic(prev) && (prev.campaign !== curr.campaign || prev.source !== curr.source)) {\n        return [true, curr];\n      }\n    }\n    return [false, prev];\n  }\n\n  function ord(utm) {\n    switch (utm.campaign) {\n      case DIRECT:\n        return 0;\n      case ORGANIC:\n        return 1;\n      case REFERRAL:\n        return 2;\n      default:\n        return 3;\n    }\n  }\n\n  function isCampaignTraffic(utm) {\n    return [DIRECT, REFERRAL, ORGANIC].indexOf(utm.campaign) === -1;\n  }\n}\n\n/**\n * Expiring queue implementation. Fires callback on elapsed timeout since last last update or creation.\n * @param callback\n * @param ttl\n * @constructor\n */\nexport function ExpiringQueue(callback, ttl) {\n  let queue = [];\n  let timeoutId;\n\n  this.push = (event) => {\n    if (event instanceof Array) {\n      queue.push.apply(queue, event);\n    } else {\n      queue.push(event);\n    }\n    reset();\n  };\n\n  this.popAll = () => {\n    let result = queue;\n    queue = [];\n    reset();\n    return result;\n  };\n\n  /**\n   * For test/debug purposes only\n   * @return {Array}\n   */\n  this.peekAll = () => {\n    return queue;\n  };\n\n  this.init = reset;\n\n  function reset() {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n    }\n    timeoutId = setTimeout(() => {\n      if (queue.length) {\n        callback();\n      }\n    }, ttl);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./modules/adkernelAdnAnalyticsAdapter.js"],"sourceRoot":""}