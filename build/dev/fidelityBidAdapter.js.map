{"version":3,"sources":["webpack:///./modules/fidelityBidAdapter.js"],"names":["utils","BIDDER_CODE","BIDDER_SERVER","spec","code","isBidRequestValid","bid","params","zoneid","buildRequests","validBidRequests","bidderRequest","map","server","bidRequest","payload","from","v","requestid","bidderRequestId","impid","bidId","floor","parseFloat","charset","document","charSet","characterSet","defloc","getTopWindowUrl","altloc","window","location","href","subid","flashver","getFlashVersion","tmax","timeout","referrer","method","url","data","interpretResponse","serverResponse","body","bidResponses","seatbid","forEach","seatBid","bidResponse","requestId","creativeId","cpm","price","width","height","ad","adm","netRevenue","currency","cur","ttl","push","getUserSyncs","syncOptions","iframeEnabled","type","plugins","plugin","result","navigator","length","i","name","indexOf","description","split"],"mappings":"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","file":"fidelityBidAdapter.js","sourcesContent":["import * as utils from 'src/utils';\r\nimport {registerBidder} from 'src/adapters/bidderFactory';\r\n\r\nconst BIDDER_CODE = 'fidelity';\r\nconst BIDDER_SERVER = 'x.fidelity-media.com';\r\nexport const spec = {\r\n  code: BIDDER_CODE,\r\n  isBidRequestValid: function(bid) {\r\n    return !!(bid && bid.params && bid.params.zoneid);\r\n  },\r\n  buildRequests: function(validBidRequests, bidderRequest) {\n    return validBidRequests.map(bidRequest => {\n      var server = bidRequest.params.server || BIDDER_SERVER;\n\n      const payload = {\n        from: 'hb',\n        v: '1.0',\n        requestid: bidRequest.bidderRequestId,\n        impid: bidRequest.bidId,\n        zoneid: bidRequest.params.zoneid,\n        floor: parseFloat(bidRequest.params.floor) > 0 ? bidRequest.params.floor : 0,\n        charset: document.charSet || document.characterSet,\n        defloc: utils.getTopWindowUrl(),\n        altloc: window.location.href,\n        subid: 'hb',\n        flashver: getFlashVersion(),\n        tmax: bidderRequest.timeout,\n      };\n      if (document.referrer) {\n        payload.referrer = document.referrer;\r\n      }\r\n\n      return {\n        method: 'GET',\n        url: '//' + server + '/delivery/hb.php',\n        data: payload\n      };\n    });\n  },\n  interpretResponse: function(serverResponse) {\r\n    serverResponse = serverResponse.body;\r\n    const bidResponses = [];\n    if (serverResponse && serverResponse.seatbid) {\n      serverResponse.seatbid.forEach(seatBid => seatBid.bid.forEach(bid => {\n        const bidResponse = {\n          requestId: bid.impid,\r\n          creativeId: bid.impid,\n          cpm: bid.price,\n          width: bid.width,\n          height: bid.height,\n          ad: bid.adm,\n          netRevenue: bid.netRevenue,\n          currency: bid.cur,\n          ttl: bid.ttl,\r\n        };\n\n        bidResponses.push(bidResponse);\n      }));\n    }\n    return bidResponses;\r\n  },\n  getUserSyncs: function getUserSyncs(syncOptions) {\n    if (syncOptions.iframeEnabled) {\n      return [{\r\n        type: 'iframe',\r\n        url: '//' + BIDDER_SERVER + '/delivery/matches.php?type=iframe',\r\n      }];\n    }\n  }\r\n}\r\n\r\nfunction getFlashVersion() {\n  var plugins, plugin, result;\n\n  if (navigator.plugins && navigator.plugins.length > 0) {\n    plugins = navigator.plugins;\n    for (var i = 0; i < plugins.length && !result; i++) {\n      plugin = plugins[i];\n      if (plugin.name.indexOf('Shockwave Flash') > -1) {\n        result = plugin.description.split('Shockwave Flash ')[1];\n      }\n    }\n  }\n  return result || '';\n}\r\n\r\nregisterBidder(spec);\r\n\n\n\n// WEBPACK FOOTER //\n// ./modules/fidelityBidAdapter.js"],"sourceRoot":""}