{"version":3,"sources":["webpack:///./modules/somoaudienceBidAdapter.js"],"names":["spec","code","aliases","isBidRequestValid","bid","params","placementId","buildRequests","bidRequests","map","method","url","bidRequest","toString","data","openRtbRequest","interpretResponse","response","request","bidResponseAvailable","bidResponse","bidResponses","bidId","body","bidData","seatbid","requestId","cpm","price","width","w","height","h","ad","adm","ttl","creativeId","crid","adId","netRevenue","currency","push","id","bidderRequestId","imp","openRtbImpression","at","tmax","site","openRtbSite","app","openRtbApp","device","openRtbDevice","banner","isApp","pageUrl","href","domain","hostname","ref","page","appParams","bundle","storeurl","storeUrl","name","ua","navigator","userAgent","language","browserLanguage","userLanguage","systemLanguage"],"mappings":"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","file":"somoaudienceBidAdapter.js","sourcesContent":["import {getTopWindowReferrer, getTopWindowLocation} from 'src/utils';\nimport { registerBidder } from 'src/adapters/bidderFactory';\n\nexport const spec = {\n\n  code: 'somoaudience',\n\n  aliases: ['somo'],\n\n  isBidRequestValid: bid => (\n    !!(bid && bid.params && bid.params.placementId)\n  ),\n\n  buildRequests: function(bidRequests) {\n    return bidRequests.map(bidRequest => {\n      return {\n        method: 'POST',\n        url: '//publisher-east.mobileadtrading.com/rtb/bid?s=' + bidRequest.params.placementId.toString(),\n        data: openRtbRequest(bidRequest),\n        bidRequest: bidRequest\n      };\n    });\n  },\n\n  interpretResponse(response, request) {\n    return bidResponseAvailable(request, response);\n  }\n};\n\nfunction bidResponseAvailable(bidRequest, bidResponse) {\n  let bidResponses = [];\n  let bidId = 1;\n  if (typeof bidRequest != 'undefined' && typeof bidRequest.bidRequest != 'undefined' && typeof bidRequest.bidRequest.bidId != 'undefined') {\n    bidId = bidRequest.bidRequest.bidId;\n  }\n  if (bidResponse.body) {\n    let bidData = bidResponse.body.seatbid[0].bid[0];\n    const bid = {\n      requestId: bidId,\n      cpm: bidData.price,\n      width: bidData.w,\n      height: bidData.h,\n      ad: bidData.adm,\n      ttl: 360,\n      creativeId: bidData.crid,\n      adId: bidId,\n      netRevenue: false,\n      currency: 'USD',\n    };\n    bidResponses.push(bid);\n  }\n  return bidResponses;\n}\n\nfunction openRtbRequest(bidRequest) {\n  return {\n    id: bidRequest.bidderRequestId,\n    imp: [openRtbImpression(bidRequest)],\n    at: 1,\n    tmax: 400,\n    site: openRtbSite(bidRequest),\n    app: openRtbApp(bidRequest),\n    device: openRtbDevice()\n  };\n}\n\nfunction openRtbImpression(bidRequest) {\n  return {\n    id: bidRequest.bidId,\n    banner: {}\n  };\n}\n\nfunction isApp(bidRequest) {\n  if (bidRequest.params.app) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nfunction openRtbSite(bidRequest) {\n  if (!isApp(bidRequest)) {\n    const pageUrl = getTopWindowLocation().href;\n    const domain = getTopWindowLocation().hostname;\n    return {\n      ref: getTopWindowReferrer(),\n      page: pageUrl,\n      domain: domain\n    }\n  } else {\n    return null;\n  }\n}\n\nfunction openRtbApp(bidRequest) {\n  if (isApp(bidRequest)) {\n    const appParams = bidRequest.params.app;\n    return {\n      bundle: appParams.bundle ? appParams.bundle : null,\n      storeurl: appParams.storeUrl ? appParams.storeUrl : null,\n      domain: appParams.domain ? appParams.domain : null,\n      name: appParams.name ? appParams.name : null,\n    }\n  } else {\n    return null;\n  }\n}\n\nfunction openRtbDevice() {\n  return {\n    ua: navigator.userAgent,\n    language: (navigator.language || navigator.browserLanguage || navigator.userLanguage || navigator.systemLanguage),\n  };\n}\n\nregisterBidder(spec);\n\n\n\n// WEBPACK FOOTER //\n// ./modules/somoaudienceBidAdapter.js"],"sourceRoot":""}