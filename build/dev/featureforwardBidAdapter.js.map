{"version":3,"sources":["webpack:///./modules/featureforwardBidAdapter.js"],"names":["FeatureForwardAdapter","bidUrl","window","location","protocol","ajaxOptions","method","withCredentials","contentType","_callBids","bidderRequest","bids","forEach","i","bidRequest","sizes","undefined","params","environment","postRequest","JSON","stringify","url","bidResponse","bidResponseAvailable","e","ca","href","refurl","referrer","ew","document","documentElement","clientWidth","eh","clientHeight","ln","navigator","language","browserLanguage","userLanguage","systemLanguage","top","rawResponse","parse","bid","GOOD","bidderCode","bidder","cpm","bidCpm","ad","html","width","height","placementCode","passback","NO_BID","ex","callBids","module","exports"],"mappings":"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","file":"featureforwardBidAdapter.js","sourcesContent":["import {createBid} from 'src/bidfactory';\nimport {addBidResponse} from 'src/bidmanager';\nimport {registerBidAdapter} from 'src/adaptermanager';\nimport {logError, getTopWindowLocation} from 'src/utils';\nimport {ajax} from 'src/ajax';\nimport {STATUS} from 'src/constants';\n\nfunction FeatureForwardAdapter() {\n  const bidUrl = window.location.protocol + '//prmbdr.featureforward.com/newbidder/bidder1_prm.php?';\n  const ajaxOptions = {\n    method: 'POST',\n    withCredentials: true,\n    contentType: 'text/plain'\n  };\n\n  function _callBids(bidderRequest) {\n    bidderRequest.bids.forEach(bidRequest => {\n      var i = 0;\n      try {\n        while (bidRequest.sizes[i] !== undefined) {\n          var params = Object.assign({}, environment(), bidRequest.params, {'size': bidRequest.sizes[i]});\n          var postRequest = JSON.stringify(params);\n          var url = bidUrl;\n          i++;\n          ajax(url, (bidResponse) => {\n            bidResponseAvailable(bidRequest, bidResponse);\n          }, postRequest, ajaxOptions);\n        }\n      } catch (e) {\n        // register passback on any exceptions while attempting to fetch response.\n        logError('featureforward.requestBid', 'ERROR', e);\n        bidResponseAvailable(bidRequest);\n      }\n    });\n  }\n\n  function environment() {\n    return {\n      ca: 'BID',\n      'if': 0,\n      url: getTopWindowLocation().href,\n      refurl: referrer(),\n      ew: document.documentElement.clientWidth,\n      eh: document.documentElement.clientHeight,\n      ln: (navigator.language || navigator.browserLanguage || navigator.userLanguage || navigator.systemLanguage)\n    };\n  }\n\n  function referrer() {\n    try {\n      return window.top.document.referrer;\n    } catch (e) {\n      return document.referrer;\n    }\n  }\n\n  function bidResponseAvailable(bidRequest, rawResponse) {\n    if (rawResponse) {\n      var bidResponse = parse(rawResponse);\n      if (bidResponse) {\n        var bid = createBid(STATUS.GOOD, bidRequest);\n        bid.bidderCode = bidRequest.bidder;\n        bid.cpm = bidResponse.bidCpm;\n        bid.ad = bidResponse.html;\n        bid.width = bidResponse.width;\n        bid.height = bidResponse.height;\n        addBidResponse(bidRequest.placementCode, bid);\n        return;\n      }\n    }\n    var passback = createBid(STATUS.NO_BID, bidRequest);\n    passback.bidderCode = bidRequest.bidder;\n    addBidResponse(bidRequest.placementCode, passback);\n  }\n\n  function parse(rawResponse) {\n    try {\n      return JSON.parse(rawResponse);\n    } catch (ex) {\n      logError('featureforward.safeParse', 'ERROR', ex);\n      return null;\n    }\n  }\n\n  return {\n    callBids: _callBids\n  };\n}\n\nregisterBidAdapter(new FeatureForwardAdapter(), 'featureforward');\n\nmodule.exports = FeatureForwardAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/featureforwardBidAdapter.js"],"sourceRoot":""}