{"version":3,"sources":["webpack:///./modules/smartadserverBidAdapter.js"],"names":["utils","require","bidfactory","bidmanager","adloader","url","adaptermanager","SmartAdServer","generateCallback","bid","callbackId","getUniqueIdentifierStr","pbjs","adUnit","bidObject","logMessage","placementCode","createBid","bidderCode","cpm","currency","ad","width","height","dealId","addBidResponse","callBids","params","i","bids","length","adCall","parse","domain","pathname","search","siteId","pageId","formatId","bidfloor","encodeURIComponent","target","sizes","map","size","join","loadScript","format","registerBidAdapter","module","exports"],"mappings":"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","file":"smartadserverBidAdapter.js","sourcesContent":["var utils = require('src/utils.js');\nvar bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar adloader = require('src/adloader.js');\nvar url = require('src/url.js');\nvar adaptermanager = require('src/adaptermanager');\n\nvar SmartAdServer = function SmartAdServer() {\n  var generateCallback = function(bid) {\n    var callbackId = 'sas_' + utils.getUniqueIdentifierStr();\n    pbjs[callbackId] = function(adUnit) {\n      var bidObject;\n      if (adUnit) {\n        utils.logMessage(`[SmartAdServer] bid response for placementCode ${bid.placementCode}`);\n        bidObject = bidfactory.createBid(1);\n        bidObject.bidderCode = 'smartadserver';\n        bidObject.cpm = adUnit.cpm;\n        bidObject.currency = adUnit.currency;\n        bidObject.ad = adUnit.ad;\n        bidObject.width = adUnit.width;\n        bidObject.height = adUnit.height;\n        bidObject.dealId = adUnit.dealId;\n        bidmanager.addBidResponse(bid.placementCode, bidObject);\n      } else {\n        utils.logMessage(`[SmartAdServer] no bid response for placementCode ${bid.placementCode}`);\n        bidObject = bidfactory.createBid(2);\n        bidObject.bidderCode = 'smartadserver';\n        bidmanager.addBidResponse(bid.placementCode, bidObject);\n      }\n    };\n    return callbackId;\n  };\n\n  return {\n    callBids: function(params) {\n      for (var i = 0; i < params.bids.length; i++) {\n        var bid = params.bids[i];\n        var adCall = url.parse(bid.params.domain);\n        adCall.pathname = '/prebid';\n        adCall.search = {\n          'pbjscbk': 'pbjs.' + generateCallback(bid),\n          'siteid': bid.params.siteId,\n          'pgid': bid.params.pageId,\n          'fmtid': bid.params.formatId,\n          'ccy': bid.params.currency || 'USD',\n          'bidfloor': bid.params.bidfloor || 0.0,\n          'tgt': encodeURIComponent(bid.params.target || ''),\n          'tag': bid.placementCode,\n          'sizes': bid.sizes.map(size => size[0] + 'x' + size[1]).join(','),\n          'async': 1\n        };\n        adloader.loadScript(url.format(adCall));\n      }\n    }\n  };\n};\n\nadaptermanager.registerBidAdapter(new SmartAdServer(), 'smartadserver');\n\nmodule.exports = SmartAdServer;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/smartadserverBidAdapter.js"],"sourceRoot":""}