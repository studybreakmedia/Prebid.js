{"version":3,"sources":["webpack:///./modules/pulsepointLiteBidAdapter.js"],"names":["NATIVE_DEFAULTS","TITLE_LEN","DESCR_LEN","SPONSORED_BY_LEN","IMG_MIN","ICON_MIN","DEFAULT_BID_TTL","DEFAULT_CURRENCY","DEFAULT_NET_REVENUE","spec","code","aliases","supportedMediaTypes","isBidRequestValid","bid","params","cp","ct","buildRequests","request","id","bidRequests","bidderRequestId","imp","map","impression","slot","site","app","device","method","url","data","JSON","stringify","interpretResponse","response","bidResponseAvailable","getUserSyncs","syncOptions","iframeEnabled","type","pixelEnabled","bidRequest","bidResponse","idToImpMap","idToBidMap","body","ortbRequest","parse","forEach","seatbid","seatBid","impid","bids","Object","keys","requestId","cpm","price","creative_id","creativeId","adId","ttl","netRevenue","currency","nativeResponse","mediaType","ad","adm","width","banner","w","height","h","applyExt","push","ortbBid","ext","bidId","nativeImpression","tagid","toString","size","adSize","nativeParams","assets","addAsset","titleAsset","length","title","dataAsset","sponsoredBy","imageAsset","icon","image","ver","asset","defaultLen","required","len","defaultMinWidth","defaultMinHeight","img","wmin","hmin","bidderRequest","pubId","appParams","publisher","ref","referrer","page","href","bundle","storeurl","storeUrl","domain","window","top","document","e","ua","navigator","userAgent","language","browserLanguage","userLanguage","systemLanguage","rawResponse","ex","cf","toUpperCase","split","parseInt","cw","ch","nativeAd","text","value","link","clickUrl","encodeURIComponent","impressionTrackers","imptrackers"],"mappings":"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","file":"pulsepointLiteBidAdapter.js","sourcesContent":["/* eslint dot-notation:0, quote-props:0 */\nimport {logError, getTopWindowLocation} from 'src/utils';\nimport { registerBidder } from 'src/adapters/bidderFactory';\n\nconst NATIVE_DEFAULTS = {\n  TITLE_LEN: 100,\n  DESCR_LEN: 200,\n  SPONSORED_BY_LEN: 50,\n  IMG_MIN: 150,\n  ICON_MIN: 50,\n};\n\nconst DEFAULT_BID_TTL = 20;\nconst DEFAULT_CURRENCY = 'USD';\nconst DEFAULT_NET_REVENUE = true;\n\n/**\n * PulsePoint \"Lite\" Adapter.  This adapter implementation is lighter than the\n * alternative/original PulsePointAdapter because it has no external\n * dependencies and relies on a single OpenRTB request to the PulsePoint\n * bidder instead of separate requests per slot.\n */\nexport const spec = {\n\n  code: 'pulseLite',\n\n  aliases: ['pulsepointLite'],\n\n  supportedMediaTypes: ['native'],\n\n  isBidRequestValid: bid => (\n    !!(bid && bid.params && bid.params.cp && bid.params.ct)\n  ),\n\n  buildRequests: bidRequests => {\n    const request = {\n      id: bidRequests[0].bidderRequestId,\n      imp: bidRequests.map(slot => impression(slot)),\n      site: site(bidRequests),\n      app: app(bidRequests),\n      device: device(),\n    };\n    return {\n      method: 'POST',\n      url: '//bid.contextweb.com/header/ortb',\n      data: JSON.stringify(request),\n    };\n  },\n\n  interpretResponse: (response, request) => (\n    bidResponseAvailable(request, response)\n  ),\n\n  getUserSyncs: syncOptions => {\n    if (syncOptions.iframeEnabled) {\n      return [{\n        type: 'iframe',\n        url: '//bh.contextweb.com/visitormatch'\n      }];\n    } else if (syncOptions.pixelEnabled) {\n      return [{\n        type: 'image',\n        url: '//bh.contextweb.com/visitormatch/prebid'\n      }];\n    }\n  }\n\n};\n\n/**\n * Callback for bids, after the call to PulsePoint completes.\n */\nfunction bidResponseAvailable(bidRequest, bidResponse) {\n  const idToImpMap = {};\n  const idToBidMap = {};\n  bidResponse = bidResponse.body\n  // extract the request bids and the response bids, keyed by impr-id\n  const ortbRequest = parse(bidRequest.data);\n  ortbRequest.imp.forEach(imp => {\n    idToImpMap[imp.id] = imp;\n  });\n  if (bidResponse) {\n    bidResponse.seatbid.forEach(seatBid => seatBid.bid.forEach(bid => {\n      idToBidMap[bid.impid] = bid;\n    }));\n  }\n  const bids = [];\n  Object.keys(idToImpMap).forEach(id => {\n    if (idToBidMap[id]) {\n      const bid = {\n        requestId: id,\n        cpm: idToBidMap[id].price,\n        creative_id: id,\n        creativeId: id,\n        adId: id,\n        ttl: DEFAULT_BID_TTL,\n        netRevenue: DEFAULT_NET_REVENUE,\n        currency: DEFAULT_CURRENCY\n      };\n      if (idToImpMap[id]['native']) {\n        bid['native'] = nativeResponse(idToImpMap[id], idToBidMap[id]);\n        bid.mediaType = 'native';\n      } else {\n        bid.ad = idToBidMap[id].adm;\n        bid.width = idToImpMap[id].banner.w;\n        bid.height = idToImpMap[id].banner.h;\n      }\n      applyExt(bid, idToBidMap[id])\n      bids.push(bid);\n    }\n  });\n  return bids;\n}\n\nfunction applyExt(bid, ortbBid) {\n  if (ortbBid && ortbBid.ext) {\n    bid.ttl = ortbBid.ext.ttl || bid.ttl;\n    bid.currency = ortbBid.ext.currency || bid.currency;\n    bid.netRevenue = ortbBid.ext.netRevenue != null ? ortbBid.ext.netRevenue : bid.netRevenue;\n  }\n}\n\n/**\n * Produces an OpenRTBImpression from a slot config.\n */\nfunction impression(slot) {\n  return {\n    id: slot.bidId,\n    banner: banner(slot),\n    'native': nativeImpression(slot),\n    tagid: slot.params.ct.toString(),\n  };\n}\n\n/**\n * Produces an OpenRTB Banner object for the slot given.\n */\nfunction banner(slot) {\n  const size = adSize(slot);\n  return slot.nativeParams ? null : {\n    w: size[0],\n    h: size[1],\n  };\n}\n\n/**\n * Produces an OpenRTB Native object for the slot given.\n */\nfunction nativeImpression(slot) {\n  if (slot.nativeParams) {\n    const assets = [];\n    addAsset(assets, titleAsset(assets.length + 1, slot.nativeParams.title, NATIVE_DEFAULTS.TITLE_LEN));\n    addAsset(assets, dataAsset(assets.length + 1, slot.nativeParams.body, 2, NATIVE_DEFAULTS.DESCR_LEN));\n    addAsset(assets, dataAsset(assets.length + 1, slot.nativeParams.sponsoredBy, 1, NATIVE_DEFAULTS.SPONSORED_BY_LEN));\n    addAsset(assets, imageAsset(assets.length + 1, slot.nativeParams.icon, 1, NATIVE_DEFAULTS.ICON_MIN, NATIVE_DEFAULTS.ICON_MIN));\n    addAsset(assets, imageAsset(assets.length + 1, slot.nativeParams.image, 3, NATIVE_DEFAULTS.IMG_MIN, NATIVE_DEFAULTS.IMG_MIN));\n    return {\n      request: JSON.stringify({ assets }),\n      ver: '1.1',\n    };\n  }\n  return null;\n}\n\n/**\n * Helper method to add an asset to the assets list.\n */\nfunction addAsset(assets, asset) {\n  if (asset) {\n    assets.push(asset);\n  }\n}\n\n/**\n * Produces a Native Title asset for the configuration given.\n */\nfunction titleAsset(id, params, defaultLen) {\n  if (params) {\n    return {\n      id,\n      required: params.required ? 1 : 0,\n      title: {\n        len: params.len || defaultLen,\n      },\n    };\n  }\n  return null;\n}\n\n/**\n * Produces a Native Image asset for the configuration given.\n */\nfunction imageAsset(id, params, type, defaultMinWidth, defaultMinHeight) {\n  return params ? {\n    id,\n    required: params.required ? 1 : 0,\n    img: {\n      type,\n      wmin: params.wmin || defaultMinWidth,\n      hmin: params.hmin || defaultMinHeight,\n    }\n  } : null;\n}\n\n/**\n * Produces a Native Data asset for the configuration given.\n */\nfunction dataAsset(id, params, type, defaultLen) {\n  return params ? {\n    id,\n    required: params.required ? 1 : 0,\n    data: {\n      type,\n      len: params.len || defaultLen,\n    }\n  } : null;\n}\n\n/**\n * Produces an OpenRTB site object.\n */\nfunction site(bidderRequest) {\n  const pubId = bidderRequest && bidderRequest.length > 0 ? bidderRequest[0].params.cp : '0';\n  const appParams = bidderRequest[0].params.app;\n  if (!appParams) {\n    return {\n      publisher: {\n        id: pubId.toString(),\n      },\n      ref: referrer(),\n      page: getTopWindowLocation().href,\n    }\n  }\n  return null;\n}\n\n/**\n * Produces an OpenRTB App object.\n */\nfunction app(bidderRequest) {\n  const pubId = bidderRequest && bidderRequest.length > 0 ? bidderRequest[0].params.cp : '0';\n  const appParams = bidderRequest[0].params.app;\n  if (appParams) {\n    return {\n      publisher: {\n        id: pubId.toString(),\n      },\n      bundle: appParams.bundle,\n      storeurl: appParams.storeUrl,\n      domain: appParams.domain,\n    }\n  }\n  return null;\n}\n\n/**\n * Attempts to capture the referrer url.\n */\nfunction referrer() {\n  try {\n    return window.top.document.referrer;\n  } catch (e) {\n    return document.referrer;\n  }\n}\n\n/**\n * Produces an OpenRTB Device object.\n */\nfunction device() {\n  return {\n    ua: navigator.userAgent,\n    language: (navigator.language || navigator.browserLanguage || navigator.userLanguage || navigator.systemLanguage),\n  };\n}\n\n/**\n * Safely parses the input given. Returns null on\n * parsing failure.\n */\nfunction parse(rawResponse) {\n  try {\n    if (rawResponse) {\n      return JSON.parse(rawResponse);\n    }\n  } catch (ex) {\n    logError('pulsepointLite.safeParse', 'ERROR', ex);\n  }\n  return null;\n}\n\n/**\n * Determines the AdSize for the slot.\n */\nfunction adSize(slot) {\n  if (slot.params.cf) {\n    const size = slot.params.cf.toUpperCase().split('X');\n    const width = parseInt(slot.params.cw || size[0], 10);\n    const height = parseInt(slot.params.ch || size[1], 10);\n    return [width, height];\n  }\n  return [1, 1];\n}\n\n/**\n * Parses the native response from the Bid given.\n */\nfunction nativeResponse(imp, bid) {\n  if (imp['native']) {\n    const nativeAd = parse(bid.adm);\n    const keys = {};\n    if (nativeAd && nativeAd['native'] && nativeAd['native'].assets) {\n      nativeAd['native'].assets.forEach(asset => {\n        keys.title = asset.title ? asset.title.text : keys.title;\n        keys.body = asset.data && asset.data.type === 2 ? asset.data.value : keys.body;\n        keys.sponsoredBy = asset.data && asset.data.type === 1 ? asset.data.value : keys.sponsoredBy;\n        keys.image = asset.img && asset.img.type === 3 ? asset.img.url : keys.image;\n        keys.icon = asset.img && asset.img.type === 1 ? asset.img.url : keys.icon;\n      });\n      if (nativeAd['native'].link) {\n        keys.clickUrl = encodeURIComponent(nativeAd['native'].link.url);\n      }\n      keys.impressionTrackers = nativeAd['native'].imptrackers;\n      return keys;\n    }\n  }\n  return null;\n}\n\nregisterBidder(spec);\n\n\n\n// WEBPACK FOOTER //\n// ./modules/pulsepointLiteBidAdapter.js"],"sourceRoot":""}