{"version":3,"sources":["webpack:///./src/AnalyticsAdapter.js","webpack:///./modules/pubwiseAnalyticsAdapter.js"],"names":["AnalyticsAdapter","events","require","utils","AUCTION_INIT","EVENTS","AUCTION_END","BID_REQUESTED","BID_TIMEOUT","BID_RESPONSE","BID_WON","BID_ADJUSTMENT","SET_TARGETING","LIBRARY","ENDPOINT","BUNDLE","_sampled","url","analyticsType","global","handler","_queue","_eventCount","_enableCheck","_handlers","_emptyQueue","track","_track","enqueue","_enqueue","enableAnalytics","_enable","disableAnalytics","_disable","getAdapterType","getGlobal","getHandler","getUrl","eventType","args","window","_callEndpoint","arguments","callback","JSON","stringify","_this","push","config","options","sampling","Math","random","parseFloat","getEvents","forEach","event","call","_each","on","logMessage","off","i","length","fn","analyticsName","defaultUrl","pubwiseVersion","configOptions","site","endpoint","debug","pwAnalyticsEnabled","utmKeys","utm_source","utm_medium","utm_campaign","utm_term","utm_content","markEnabled","logInfo","enrichWithMetrics","dataBag","pbjs","version","e","enrichWithUTM","newUtm","prop","urlValue","getParameterByName","itemValue","localStorage","getItem","setItem","sendEvent","data","target_site","result","pubwiseAnalytics","adapterEnableAnalytics","undefined","debugTurnedOn","registerAnalyticsAdapter","adapter","code"],"mappings":"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","file":"pubwiseAnalyticsAdapter.js","sourcesContent":["import CONSTANTS from './constants';\nimport { loadScript } from './adloader';\nimport { ajax } from './ajax';\n\nconst events = require('./events');\nconst utils = require('./utils');\n\nconst AUCTION_INIT = CONSTANTS.EVENTS.AUCTION_INIT;\nconst AUCTION_END = CONSTANTS.EVENTS.AUCTION_END;\nconst BID_REQUESTED = CONSTANTS.EVENTS.BID_REQUESTED;\nconst BID_TIMEOUT = CONSTANTS.EVENTS.BID_TIMEOUT;\nconst BID_RESPONSE = CONSTANTS.EVENTS.BID_RESPONSE;\nconst BID_WON = CONSTANTS.EVENTS.BID_WON;\nconst BID_ADJUSTMENT = CONSTANTS.EVENTS.BID_ADJUSTMENT;\nconst SET_TARGETING = CONSTANTS.EVENTS.SET_TARGETING;\n\nconst LIBRARY = 'library';\nconst ENDPOINT = 'endpoint';\nconst BUNDLE = 'bundle';\n\nvar _sampled = true;\n\nexport default function AnalyticsAdapter({ url, analyticsType, global, handler }) {\n  var _queue = [];\n  var _eventCount = 0;\n  var _enableCheck = true;\n  var _handlers;\n\n  if (analyticsType === LIBRARY) {\n    loadScript(url, _emptyQueue);\n  }\n\n  if (analyticsType === ENDPOINT || BUNDLE) {\n    _emptyQueue();\n  }\n\n  return {\n    track: _track,\n    enqueue: _enqueue,\n    enableAnalytics: _enable,\n    disableAnalytics: _disable,\n    getAdapterType: () => analyticsType,\n    getGlobal: () => global,\n    getHandler: () => handler,\n    getUrl: () => url\n  };\n\n  function _track({ eventType, args }) {\n    if (this.getAdapterType() === LIBRARY || BUNDLE) {\n      window[global](handler, eventType, args);\n    }\n\n    if (this.getAdapterType() === ENDPOINT) {\n      _callEndpoint(...arguments);\n    }\n  }\n\n  function _callEndpoint({ eventType, args, callback }) {\n    ajax(url, callback, JSON.stringify({ eventType, args }));\n  }\n\n  function _enqueue({ eventType, args }) {\n    const _this = this;\n\n    if (global && window[global] && eventType && args) {\n      this.track({ eventType, args });\n    } else {\n      _queue.push(function () {\n        _eventCount++;\n        _this.track({ eventType, args });\n      });\n    }\n  }\n\n  function _enable(config) {\n    var _this = this;\n\n    if (typeof config === 'object' && typeof config.options === 'object') {\n      _sampled = typeof config.options.sampling === 'undefined' || Math.random() < parseFloat(config.options.sampling);\n    } else {\n      _sampled = true;\n    }\n\n    if (_sampled) {\n      // first send all events fired before enableAnalytics called\n      events.getEvents().forEach(event => {\n        if (!event) {\n          return;\n        }\n\n        const { eventType, args } = event;\n\n        if (eventType !== BID_TIMEOUT) {\n          _enqueue.call(_this, { eventType, args });\n        }\n      });\n\n      // Next register event listeners to send data immediately\n\n      _handlers = {\n        [BID_REQUESTED]: args => this.enqueue({ eventType: BID_REQUESTED, args }),\n        [BID_RESPONSE]: args => this.enqueue({ eventType: BID_RESPONSE, args }),\n        [BID_TIMEOUT]: args => this.enqueue({ eventType: BID_TIMEOUT, args }),\n        [BID_WON]: args => this.enqueue({ eventType: BID_WON, args }),\n        [BID_ADJUSTMENT]: args => this.enqueue({ eventType: BID_ADJUSTMENT, args }),\n        [SET_TARGETING]: args => this.enqueue({ eventType: SET_TARGETING, args }),\n        [AUCTION_END]: args => this.enqueue({ eventType: AUCTION_END, args }),\n        [AUCTION_INIT]: args => {\n          args.config = config.options; // enableAnaltyics configuration object\n          this.enqueue({ eventType: AUCTION_INIT, args });\n        }\n      };\n\n      utils._each(_handlers, (handler, event) => {\n        events.on(event, handler);\n      });\n    } else {\n      utils.logMessage(`Analytics adapter for \"${global}\" disabled by sampling`);\n    }\n\n    // finally set this function to return log message, prevents multiple adapter listeners\n    this.enableAnalytics = function _enable() {\n      return utils.logMessage(`Analytics adapter for \"${global}\" already enabled, unnecessary call to \\`enableAnalytics\\`.`);\n    };\n  }\n\n  function _disable() {\n    utils._each(_handlers, (handler, event) => {\n      events.off(event, handler);\n    });\n  }\n\n  function _emptyQueue() {\n    if (_enableCheck) {\n      for (var i = 0; i < _queue.length; i++) {\n        _queue[i]();\n      }\n\n      // override push to execute the command immediately from now on\n      _queue.push = function (fn) {\n        fn();\n      };\n\n      _enableCheck = false;\n    }\n\n    utils.logMessage(`event count sent to ${global}: ${_eventCount}`);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/AnalyticsAdapter.js","import {ajax} from 'src/ajax';\nimport adapter from 'src/AnalyticsAdapter';\nimport adaptermanager from 'src/adaptermanager';\nimport CONSTANTS from 'src/constants.json';\nconst utils = require('src/utils');\n\n/****\n * PubWise.io Analytics\n * Contact: support@pubwise.io\n * Developer: Stephen Johnston\n *\n * For testing:\n *\n pbjs.enableAnalytics({\n  provider: 'pubwise',\n  options: {\n    site: 'test-test-test-test',\n    endpoint: 'https://api.pubwise.io/api/v4/event/add/',\n  }\n });\n */\n\nconst analyticsType = 'endpoint';\nconst analyticsName = 'PubWise Analytics: ';\nlet defaultUrl = 'https://api.pubwise.io/api/v4/event/default/';\nlet pubwiseVersion = '2.2';\nlet configOptions = {site: '', endpoint: 'https://api.pubwise.io/api/v4/event/default/', debug: ''};\nlet pwAnalyticsEnabled = false;\nlet utmKeys = {utm_source: '', utm_medium: '', utm_campaign: '', utm_term: '', utm_content: ''};\n\nfunction markEnabled() {\n  utils.logInfo(`${analyticsName}Enabled`, configOptions);\n  pwAnalyticsEnabled = true;\n}\n\nfunction enrichWithMetrics(dataBag) {\n  try {\n    dataBag['pw_version'] = pubwiseVersion;\n    dataBag['pbjs_version'] = pbjs.version;\n    dataBag['debug'] = configOptions.debug;\n  } catch (e) {\n    dataBag['error_metric'] = 1;\n  }\n\n  return dataBag;\n}\n\nfunction enrichWithUTM(dataBag) {\n  let newUtm = false;\n  try {\n    for (let prop in utmKeys) {\n      let urlValue = utils.getParameterByName(prop);\n      utmKeys[prop] = urlValue;\n      if (utmKeys[prop] != '') {\n        newUtm = true;\n        dataBag[prop] = utmKeys[prop];\n      }\n    }\n\n    if (newUtm === false) {\n      for (let prop in utmKeys) {\n        let itemValue = localStorage.getItem(`pw-${prop}`);\n        if (itemValue.length !== 0) {\n          dataBag[prop] = itemValue;\n        }\n      }\n    } else {\n      for (let prop in utmKeys) {\n        localStorage.setItem(`pw-${prop}`, utmKeys[prop]);\n      }\n    }\n  } catch (e) {\n    utils.logInfo(`${analyticsName}Error`, e);\n    dataBag['error_utm'] = 1;\n  }\n  return dataBag;\n}\n\nfunction sendEvent(eventType, data) {\n  utils.logInfo(`${analyticsName}Event ${eventType} ${pwAnalyticsEnabled}`, data);\n\n  // put the typical items in the data bag\n  let dataBag = {\n    eventType: eventType,\n    args: data,\n    target_site: configOptions.site,\n    debug: configOptions.debug ? 1 : 0,\n  };\n\n  // for certain events, track additional info\n  if (eventType == CONSTANTS.EVENTS.AUCTION_INIT) {\n    dataBag = enrichWithMetrics(dataBag);\n    dataBag = enrichWithUTM(dataBag);\n  }\n\n  ajax(configOptions.endpoint, (result) => utils.logInfo(`${analyticsName}Result`, result), JSON.stringify(dataBag));\n}\n\nlet pubwiseAnalytics = Object.assign(adapter(\n  {\n    defaultUrl,\n    analyticsType\n  }),\n{\n  // Override AnalyticsAdapter functions by supplying custom methods\n  track({eventType, args}) {\n    sendEvent(eventType, args);\n  }\n});\n\npubwiseAnalytics.adapterEnableAnalytics = pubwiseAnalytics.enableAnalytics;\n\npubwiseAnalytics.enableAnalytics = function (config) {\n  if (config.options.debug === undefined) {\n    config.options.debug = utils.debugTurnedOn();\n  }\n  configOptions = config.options;\n  markEnabled();\n  pubwiseAnalytics.adapterEnableAnalytics(config);\n};\n\nadaptermanager.registerAnalyticsAdapter({\n  adapter: pubwiseAnalytics,\n  code: 'pubwise'\n});\n\nexport default pubwiseAnalytics;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/pubwiseAnalyticsAdapter.js"],"sourceRoot":""}