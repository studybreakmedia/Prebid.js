{"version":3,"sources":["webpack:///./modules/innityBidAdapter.js"],"names":["bidfactory","require","bidmanager","adloader","utils","CONSTANTS","adaptermanager","InnityAdapter","_callBids","params","bidURL","bids","requestURL","window","location","protocol","Date","getTime","i","length","requestParams","bid","pub","zone","url","getTopWindowUrl","parseSized","parseSizesInput","sizes","arrSize","split","width","height","callback","callback_uid","bidId","parseQueryStringParameters","logMessage","loadScript","pbjs","_doInnityCallback","response","bidObject","bidRequest","callbackID","libURL","getBidRequest","cpm","createBid","STATUS","GOOD","bidderCode","parseFloat","ad","tag","NO_BID","addBidResponse","placementCode","callBids","registerBidAdapter","module","exports"],"mappings":"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","file":"innityBidAdapter.js","sourcesContent":["var bidfactory = require('src/bidfactory.js');\nvar bidmanager = require('src/bidmanager.js');\nvar adloader = require('src/adloader.js');\nvar utils = require('src/utils.js');\nvar CONSTANTS = require('src/constants.json');\nvar adaptermanager = require('src/adaptermanager');\n\nvar InnityAdapter = function InnityAdapter() {\n  function _callBids(params) {\n    var bidURL;\n    const bids = params.bids || [];\n    const requestURL = window.location.protocol + '//as.innity.com/synd/?cb=' + new Date().getTime() + '&ver=2&hb=1&output=js&';\n    for (var i = 0; i < bids.length; i++) {\n      const requestParams = {};\n      const bid = bids[i];\n      requestParams.pub = bid.params.pub;\n      requestParams.zone = bid.params.zone;\n      // Page URL\n      requestParams.url = utils.getTopWindowUrl();\n      // Sizes\n      const parseSized = utils.parseSizesInput(bid.sizes);\n      const arrSize = parseSized[0].split('x');\n      requestParams.width = arrSize[0];\n      requestParams.height = arrSize[1];\n      // Callback function\n      requestParams.callback = 'pbjs._doInnityCallback';\n      // Callback ID\n      requestParams.callback_uid = bid.bidId;\n      // Load Bidder URL\n      bidURL = requestURL + utils.parseQueryStringParameters(requestParams);\n      utils.logMessage('Innity.prebid, Bid ID: ' + bid.bidId + ', Pub ID: ' + bid.params.pub + ', Zone ID: ' + bid.params.zone + ', URL: ' + bidURL);\n      adloader.loadScript(bidURL);\n    }\n  }\n\n  pbjs._doInnityCallback = function(response) {\n    var bidObject;\n    var bidRequest;\n    var callbackID;\n    var libURL = window.location.protocol + '//cdn.innity.net/frame_util.js';\n    callbackID = response.callback_uid;\n    bidRequest = utils.getBidRequest(callbackID);\n    if (response.cpm > 0) {\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.GOOD, bidRequest);\n      bidObject.bidderCode = 'innity';\n      bidObject.cpm = parseFloat(response.cpm) / 100;\n      bidObject.ad = '<script src=\"' + libURL + '\"></script>' + response.tag;\n      bidObject.width = response.width;\n      bidObject.height = response.height;\n    } else {\n      bidObject = bidfactory.createBid(CONSTANTS.STATUS.NO_BID, bidRequest);\n      bidObject.bidderCode = 'innity';\n      utils.logMessage('No Bid response from Innity request: ' + callbackID);\n    }\n    bidmanager.addBidResponse(bidRequest.placementCode, bidObject);\n  };\n\n  return {\n    callBids: _callBids\n  };\n};\n\nadaptermanager.registerBidAdapter(new InnityAdapter(), 'innity');\n\nmodule.exports = InnityAdapter;\n\n\n\n// WEBPACK FOOTER //\n// ./modules/innityBidAdapter.js"],"sourceRoot":""}