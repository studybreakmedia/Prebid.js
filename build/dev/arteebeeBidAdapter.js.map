{"version":3,"sources":["webpack:///./modules/arteebeeBidAdapter.js"],"names":["utils","BIDDER_CODE","DEFAULT_HOST","DEFAULT_SSP","spec","code","supportedMediaTypes","isBidRequestValid","bidRequest","params","pub","undefined","source","buildRequests","validBidRequests","requests","i","length","prebidReq","makePrebidRequest","push","interpretResponse","serverResponse","rtbResp","body","seatbid","bidResponses","j","bid","bidResponse","requestId","impid","cpm","price","width","w","height","h","mediaType","creativeId","crid","currency","netRevenue","ttl","exp","ad","adm","getUserSyncs","syncOptions","serverResponses","req","host","ssp","url","window","location","protocol","payload","makeRtbRequest","payloadString","JSON","stringify","method","data","auctionId","imp","makeImp","rtbReq","makeSite","makeDevice","getConfig","coppa","regs","test","bidId","placementCode","secure","banner","makeBanner","format","sizes","site","getTopWindowUrl","getTopWindowReferrer","makePublisher","publisher","getDomain","a","document","createElement","href","device"],"mappings":"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","file":"arteebeeBidAdapter.js","sourcesContent":["import * as utils from 'src/utils';\nimport {BANNER} from 'src/mediaTypes';\nimport {registerBidder} from 'src/adapters/bidderFactory';\nimport {config} from 'src/config';\n\nconst BIDDER_CODE = 'arteebee';\n\nconst DEFAULT_HOST = 'bidder.mamrtb.com';\n\nconst DEFAULT_SSP = 'arteebee';\n\nexport const spec = {\n  code: BIDDER_CODE,\n  supportedMediaTypes: [BANNER],\n  isBidRequestValid: function (bidRequest) {\n    return 'params' in bidRequest && bidRequest.params.pub !== undefined &&\n      bidRequest.params.source !== undefined;\n  },\n  buildRequests: function (validBidRequests) {\n    var requests = [];\n\n    for (let i = 0; i < validBidRequests.length; i++) {\n      let prebidReq = makePrebidRequest(validBidRequests[i]);\n      if (prebidReq) {\n        requests.push(prebidReq);\n      }\n    }\n\n    return requests;\n  },\n  interpretResponse: function (serverResponse, bidRequest) {\n    var rtbResp = serverResponse.body;\n\n    if ((!rtbResp) || (!rtbResp.seatbid)) {\n      return [];\n    }\n\n    let bidResponses = [];\n\n    for (let i = 0; i < rtbResp.seatbid.length; i++) {\n      let seatbid = rtbResp.seatbid[i];\n      for (let j = 0; j < seatbid.bid.length; j++) {\n        let bid = seatbid.bid[j];\n        let bidResponse = {\n          requestId: bid.impid,\n          cpm: bid.price,\n          width: bid.w,\n          height: bid.h,\n          mediaType: BANNER,\n          creativeId: bid.crid,\n          currency: 'USD',\n          netRevenue: true,\n          ttl: bid.exp,\n          ad: bid.adm\n        };\n        bidResponses.push(bidResponse);\n      }\n    }\n    return bidResponses;\n  },\n  getUserSyncs: function (syncOptions, serverResponses) {\n    return [];\n  }\n}\n\nregisterBidder(spec);\n\nfunction makePrebidRequest(req) {\n  var host = req.params.host || DEFAULT_HOST;\n  var ssp = req.params.ssp || DEFAULT_SSP;\n\n  var url = window.location.protocol + '//' + host + '/rtb/bid/' + ssp + '?type=json&register=0';\n\n  const payload = makeRtbRequest(req);\n  const payloadString = JSON.stringify(payload);\n\n  return {\n    method: 'POST',\n    url: url,\n    data: payloadString\n  };\n}\n\nfunction makeRtbRequest(req) {\n  var auctionId = req.requestId;\n\n  var imp = [];\n  imp.push(makeImp(req));\n\n  var rtbReq = {\n    'id': auctionId,\n    'imp': imp,\n    'site': makeSite(req),\n    'device': makeDevice(),\n    'at': 1,\n    'tmax': config.getConfig('bidderTimeout')\n  };\n\n  if (req.params.coppa) {\n    rtbReq.regs = {coppa: 1};\n  }\n\n  if (req.params.test) {\n    rtbReq.test = 1;\n  }\n\n  return rtbReq;\n}\n\nfunction makeImp(req) {\n  var imp = {\n    'id': req.bidId,\n    'tagid': req.placementCode\n  };\n\n  if (window.location.protocol === 'https:') {\n    imp.secure = 1;\n  }\n\n  imp.banner = makeBanner(req);\n\n  return imp;\n}\n\nfunction makeBanner(req) {\n  var format = [];\n\n  for (let i = 0; i < req.sizes.length; i++) {\n    format.push({\n      w: req.sizes[i][0],\n      h: req.sizes[i][1]\n    });\n  }\n  return {\n    'format': format\n  };\n}\n\nfunction makeSite(req) {\n  var params = req.params;\n\n  var site = {\n    'id': params.source,\n    'page': utils.getTopWindowUrl(),\n    'ref': utils.getTopWindowReferrer(),\n    'publisher': makePublisher(req)\n  };\n\n  return site;\n}\n\nfunction makePublisher(req) {\n  var params = req.params;\n\n  var publisher = {\n    'id': params.pub,\n    'domain': getDomain(config.getConfig('publisherDomain'))\n  };\n\n  return publisher;\n}\n\nfunction getDomain(url) {\n  var a = document.createElement('a');\n  a.href = url;\n\n  return a.host;\n}\n\nfunction makeDevice() {\n  var device = {\n    'ua': 'caller',\n    'ip': 'caller',\n    'js': 1\n  };\n\n  return device;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./modules/arteebeeBidAdapter.js"],"sourceRoot":""}