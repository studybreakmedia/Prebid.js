{"version":3,"sources":["webpack:///./modules/undertoneBidAdapter.js"],"names":["utils","BIDDER_CODE","URL","spec","code","isBidRequestValid","bid","params","publisherId","placementId","parseInt","buildRequests","validBidRequests","payload","host","getTopWindowLocation","domain","exec","pubid","REQ_URL","map","bidRequestId","bidReq","bidId","hbadaptor","sizes","push","method","url","withCredentials","data","JSON","stringify","interpretResponse","serverResponse","request","bids","body","Array","isArray","length","forEach","bidRes","ad","cpm","requestId","width","height","creativeId","adId","currency","netRevenue","ttl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAIA;;IAAYA,K;;AACZ;;;;AALA;;;;AAOA,IAAMC,cAAc,WAApB;AACA,IAAMC,MAAM,uBAAZ;;AAEO,IAAMC,sBAAO;AAClBC,QAAMH,WADY;AAElBI,qBAAmB,2BAASC,GAAT,EAAc;AAC/B,QAAIA,OAAOA,IAAIC,MAAX,IAAqBD,IAAIC,MAAJ,CAAWC,WAAhC,IAA+CF,IAAIC,MAAJ,CAAWE,WAA9D,EAA2E;AACzEH,UAAIC,MAAJ,CAAWC,WAAX,GAAyBE,SAASJ,IAAIC,MAAJ,CAAWC,WAApB,CAAzB;AACA,aAAO,IAAP;AACD;AACF,GAPiB;AAQlBG,iBAAe,uBAASC,gBAAT,EAA2B;AACxC,QAAMC,UAAU;AACd,wBAAkB;AADJ,KAAhB;AAGA,QAAMC,OAAOd,MAAMe,oBAAN,GAA6BD,IAA1C;AACA,QAAME,SAAS,8DAA8DC,IAA9D,CAAmEH,IAAnE,CAAf;;AAEA,QAAMI,QAAQN,iBAAiB,CAAjB,EAAoBL,MAApB,CAA2BC,WAAzC;AACA,QAAMW,UAAajB,GAAb,aAAwBgB,KAAxB,gBAAwCF,MAA9C;;AAEAJ,qBAAiBQ,GAAjB,CAAqB,kBAAU;AAC7B,UAAMd,MAAM;AACVe,sBAAcC,OAAOC,KADX;AAEVC,mBAAW,QAFD;AAGVR,gBAAQA,MAHE;AAIVP,qBAAaa,OAAOf,MAAP,CAAcE,WAJjB;AAKVD,qBAAac,OAAOf,MAAP,CAAcC,WALjB;AAMViB,eAAOH,OAAOG,KANJ;AAOVlB,gBAAQe,OAAOf;AAPL,OAAZ;AASAM,cAAQ,gBAAR,EAA0Ba,IAA1B,CAA+BpB,GAA/B;AACD,KAXD;AAYA,WAAO;AACLqB,cAAQ,MADH;AAELC,WAAKT,OAFA;AAGLU,uBAAiB,IAHZ;AAILC,YAAMC,KAAKC,SAAL,CAAenB,OAAf;AAJD,KAAP;AAMD,GApCiB;AAqClBoB,qBAAmB,2BAASC,cAAT,EAAyBC,OAAzB,EAAkC;AACnD,QAAMC,OAAO,EAAb;AACA,QAAMC,OAAOH,eAAeG,IAA5B;;AAEA,QAAIA,QAAQC,MAAMC,OAAN,CAAcF,IAAd,CAAR,IAA+BA,KAAKG,MAAL,GAAc,CAAjD,EAAoD;AAClDH,WAAKI,OAAL,CAAa,UAACC,MAAD,EAAY;AACvB,YAAIA,OAAOC,EAAP,IAAaD,OAAOE,GAAP,GAAa,CAA9B,EAAiC;AAC/B,cAAMtC,MAAM;AACVuC,uBAAWH,OAAOrB,YADR;AAEVuB,iBAAKF,OAAOE,GAFF;AAGVE,mBAAOJ,OAAOI,KAHJ;AAIVC,oBAAQL,OAAOK,MAJL;AAKVC,wBAAYN,OAAOO,IALT;AAMVC,sBAAUR,OAAOQ,QANP;AAOVC,wBAAYT,OAAOS,UAPT;AAQVC,iBAAKV,OAAOU,GARF;AASVT,gBAAID,OAAOC;AATD,WAAZ;AAWAP,eAAKV,IAAL,CAAUpB,GAAV;AACD;AACF,OAfD;AAgBD;AACD,WAAO8B,IAAP;AACD;AA5DiB,CAAb;AA8DP,mCAAejC,IAAf,E","file":"undertoneBidAdapter.js","sourcesContent":["/**\n * Adapter to send bids to Undertone\n */\n\nimport * as utils from 'src/utils';\nimport { registerBidder } from 'src/adapters/bidderFactory';\n\nconst BIDDER_CODE = 'undertone';\nconst URL = '//hb.undertone.com/hb';\n\nexport const spec = {\n  code: BIDDER_CODE,\n  isBidRequestValid: function(bid) {\n    if (bid && bid.params && bid.params.publisherId && bid.params.placementId) {\n      bid.params.publisherId = parseInt(bid.params.publisherId);\n      return true;\n    }\n  },\n  buildRequests: function(validBidRequests) {\n    const payload = {\n      'x-ut-hb-params': []\n    };\n    const host = utils.getTopWindowLocation().host;\n    const domain = /[-\\w]+\\.(?:[-\\w]+\\.xn--[-\\w]+|[-\\w]{3,}|[-\\w]+\\.[-\\w]{2})$/i.exec(host);\n\n    const pubid = validBidRequests[0].params.publisherId;\n    const REQ_URL = `${URL}?pid=${pubid}&domain=${domain}`;\n\n    validBidRequests.map(bidReq => {\n      const bid = {\n        bidRequestId: bidReq.bidId,\n        hbadaptor: 'prebid',\n        domain: domain,\n        placementId: bidReq.params.placementId,\n        publisherId: bidReq.params.publisherId,\n        sizes: bidReq.sizes,\n        params: bidReq.params\n      };\n      payload['x-ut-hb-params'].push(bid);\n    });\n    return {\n      method: 'POST',\n      url: REQ_URL,\n      withCredentials: true,\n      data: JSON.stringify(payload)\n    };\n  },\n  interpretResponse: function(serverResponse, request) {\n    const bids = [];\n    const body = serverResponse.body;\n\n    if (body && Array.isArray(body) && body.length > 0) {\n      body.forEach((bidRes) => {\n        if (bidRes.ad && bidRes.cpm > 0) {\n          const bid = {\n            requestId: bidRes.bidRequestId,\n            cpm: bidRes.cpm,\n            width: bidRes.width,\n            height: bidRes.height,\n            creativeId: bidRes.adId,\n            currency: bidRes.currency,\n            netRevenue: bidRes.netRevenue,\n            ttl: bidRes.ttl,\n            ad: bidRes.ad\n          };\n          bids.push(bid);\n        }\n      });\n    }\n    return bids;\n  }\n};\nregisterBidder(spec);\n\n\n\n// WEBPACK FOOTER //\n// ./modules/undertoneBidAdapter.js"],"sourceRoot":""}